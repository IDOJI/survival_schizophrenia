<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="ido ji">

<title>Survival Analysis on Schizophrenia CHR</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Survival Analysis_files/libs/clipboard/clipboard.min.js"></script>
<script src="Survival Analysis_files/libs/quarto-html/quarto.js"></script>
<script src="Survival Analysis_files/libs/quarto-html/popper.min.js"></script>
<script src="Survival Analysis_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Survival Analysis_files/libs/quarto-html/anchor.min.js"></script>
<link href="Survival Analysis_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Survival Analysis_files/libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Survival Analysis_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Survival Analysis_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Survival Analysis_files/libs/bootstrap/bootstrap-c0367b04c37547644fece4185067e4a7.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="99">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#íŒ¨í‚¤ì§€-ì„¤ì¹˜-ë°-ë¡œë”©" id="toc-íŒ¨í‚¤ì§€-ì„¤ì¹˜-ë°-ë¡œë”©" class="nav-link active" data-scroll-target="#íŒ¨í‚¤ì§€-ì„¤ì¹˜-ë°-ë¡œë”©">ğŸ“¦ íŒ¨í‚¤ì§€ ì„¤ì¹˜ ë° ë¡œë”©</a></li>
  <li><a href="#ë°ì´í„°-ì¤€ë¹„" id="toc-ë°ì´í„°-ì¤€ë¹„" class="nav-link" data-scroll-target="#ë°ì´í„°-ì¤€ë¹„">ğŸ“Š ë°ì´í„° ì¤€ë¹„</a></li>
  <li><a href="#kaplanmeier-ìƒì¡´ë¶„ì„" id="toc-kaplanmeier-ìƒì¡´ë¶„ì„" class="nav-link" data-scroll-target="#kaplanmeier-ìƒì¡´ë¶„ì„">ğŸŸ¥ 1. Kaplanâ€“Meier ìƒì¡´ë¶„ì„</a>
  <ul>
  <li><a href="#ì „ì²´-ê·¸ë£¹" id="toc-ì „ì²´-ê·¸ë£¹" class="nav-link" data-scroll-target="#ì „ì²´-ê·¸ë£¹">ğŸŸ¨ ì „ì²´ ê·¸ë£¹</a>
  <ul class="collapse">
  <li><a href="#ì¹´í”Œë€ë§ˆì´ì–´-ì í•©" id="toc-ì¹´í”Œë€ë§ˆì´ì–´-ì í•©" class="nav-link" data-scroll-target="#ì¹´í”Œë€ë§ˆì´ì–´-ì í•©">ğŸŸª ì¹´í”Œë€â€“ë§ˆì´ì–´ ì í•©</a></li>
  <li><a href="#íŠ¹ì •-ì‹œì 730ì¼-ìƒì¡´ìœ¨" id="toc-íŠ¹ì •-ì‹œì 730ì¼-ìƒì¡´ìœ¨" class="nav-link" data-scroll-target="#íŠ¹ì •-ì‹œì 730ì¼-ìƒì¡´ìœ¨">ğŸŸª íŠ¹ì • ì‹œì (730ì¼) ìƒì¡´ìœ¨</a></li>
  <li><a href="#ì í•©ê²°ê³¼-ìš”ì•½-í•´ì„730ì¼-ì‹œì -ê¸°ì¤€" id="toc-ì í•©ê²°ê³¼-ìš”ì•½-í•´ì„730ì¼-ì‹œì -ê¸°ì¤€" class="nav-link" data-scroll-target="#ì í•©ê²°ê³¼-ìš”ì•½-í•´ì„730ì¼-ì‹œì -ê¸°ì¤€">ğŸŸª ì í•©ê²°ê³¼ ìš”ì•½ í•´ì„(730ì¼ ì‹œì  ê¸°ì¤€)</a></li>
  <li><a href="#ì¹´í”Œë€-ë§ˆì´ì–´-ê³¡ì„ -ë°-ì‹ ë¢°êµ¬ê°„-ì‹œê°í™”" id="toc-ì¹´í”Œë€-ë§ˆì´ì–´-ê³¡ì„ -ë°-ì‹ ë¢°êµ¬ê°„-ì‹œê°í™”" class="nav-link" data-scroll-target="#ì¹´í”Œë€-ë§ˆì´ì–´-ê³¡ì„ -ë°-ì‹ ë¢°êµ¬ê°„-ì‹œê°í™”">ğŸŸª ì¹´í”Œë€-ë§ˆì´ì–´ ê³¡ì„  ë° ì‹ ë¢°êµ¬ê°„ ì‹œê°í™”</a>
  <ul class="collapse">
  <li><a href="#ê·¸ë˜í”„-í•´ì„" id="toc-ê·¸ë˜í”„-í•´ì„" class="nav-link" data-scroll-target="#ê·¸ë˜í”„-í•´ì„">ğŸ“Š ê·¸ë˜í”„ í•´ì„</a></li>
  </ul></li>
  <li><a href="#ê²°ë¡ -ìš”ì•½" id="toc-ê²°ë¡ -ìš”ì•½" class="nav-link" data-scroll-target="#ê²°ë¡ -ìš”ì•½">ğŸŸª ê²°ë¡  ìš”ì•½</a></li>
  </ul></li>
  <li><a href="#ì„±ë³„-ê·¸ë£¹ë³„-ìƒì¡´-ë¶„ì„-kaplanmeier-ë°-log-rank-ê²€ì •" id="toc-ì„±ë³„-ê·¸ë£¹ë³„-ìƒì¡´-ë¶„ì„-kaplanmeier-ë°-log-rank-ê²€ì •" class="nav-link" data-scroll-target="#ì„±ë³„-ê·¸ë£¹ë³„-ìƒì¡´-ë¶„ì„-kaplanmeier-ë°-log-rank-ê²€ì •">ğŸŸ¨ ì„±ë³„ ê·¸ë£¹ë³„ ìƒì¡´ ë¶„ì„: Kaplanâ€“Meier ë° Log-rank ê²€ì •</a>
  <ul class="collapse">
  <li><a href="#kaplanmeier-ìƒì¡´ê³¡ì„ -ì„±ë³„-ê·¸ë£¹-ë¹„êµ" id="toc-kaplanmeier-ìƒì¡´ê³¡ì„ -ì„±ë³„-ê·¸ë£¹-ë¹„êµ" class="nav-link" data-scroll-target="#kaplanmeier-ìƒì¡´ê³¡ì„ -ì„±ë³„-ê·¸ë£¹-ë¹„êµ">ğŸŸª Kaplanâ€“Meier ìƒì¡´ê³¡ì„ : ì„±ë³„ ê·¸ë£¹ ë¹„êµ</a></li>
  <li><a href="#ì¼2ë…„-ì‹œì -ìƒì¡´ìœ¨-ë¹„êµ" id="toc-ì¼2ë…„-ì‹œì -ìƒì¡´ìœ¨-ë¹„êµ" class="nav-link" data-scroll-target="#ì¼2ë…„-ì‹œì -ìƒì¡´ìœ¨-ë¹„êµ">ğŸŸª 730ì¼(2ë…„) ì‹œì  ìƒì¡´ìœ¨ ë¹„êµ</a></li>
  <li><a href="#log-rank-ê²€ì •-ì„±ë³„-ê°„-ìƒì¡´ê³¡ì„ -ì°¨ì´-ê²€ì •" id="toc-log-rank-ê²€ì •-ì„±ë³„-ê°„-ìƒì¡´ê³¡ì„ -ì°¨ì´-ê²€ì •" class="nav-link" data-scroll-target="#log-rank-ê²€ì •-ì„±ë³„-ê°„-ìƒì¡´ê³¡ì„ -ì°¨ì´-ê²€ì •">ğŸŸª Log-rank ê²€ì •: ì„±ë³„ ê°„ ìƒì¡´ê³¡ì„  ì°¨ì´ ê²€ì •</a></li>
  <li><a href="#ì¢…í•©-ìš”ì•½" id="toc-ì¢…í•©-ìš”ì•½" class="nav-link" data-scroll-target="#ì¢…í•©-ìš”ì•½">ğŸŸª ì¢…í•© ìš”ì•½</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#mixture-cure-model-ph" id="toc-mixture-cure-model-ph" class="nav-link" data-scroll-target="#mixture-cure-model-ph">ğŸŸ¥ 2. Mixture Cure Model (PH)</a>
  <ul>
  <li><a href="#ë¶„ì„-ê°œìš”" id="toc-ë¶„ì„-ê°œìš”" class="nav-link" data-scroll-target="#ë¶„ì„-ê°œìš”">ğŸŸ¨ ë¶„ì„ ê°œìš”</a></li>
  <li><a href="#ìˆ˜í•™ì -ëª¨ë¸-êµ¬ì¡°" id="toc-ìˆ˜í•™ì -ëª¨ë¸-êµ¬ì¡°" class="nav-link" data-scroll-target="#ìˆ˜í•™ì -ëª¨ë¸-êµ¬ì¡°">ğŸŸ¨ ìˆ˜í•™ì  ëª¨ë¸ êµ¬ì¡°</a></li>
  <li><a href="#ëª¨ë¸-ì¶”ì •-ê²°ê³¼" id="toc-ëª¨ë¸-ì¶”ì •-ê²°ê³¼" class="nav-link" data-scroll-target="#ëª¨ë¸-ì¶”ì •-ê²°ê³¼">ğŸŸ¨ ëª¨ë¸ ì¶”ì • ê²°ê³¼</a>
  <ul class="collapse">
  <li><a href="#cure-probability-model-ì™„ì¹˜-í™•ë¥ -ëª¨í˜•" id="toc-cure-probability-model-ì™„ì¹˜-í™•ë¥ -ëª¨í˜•" class="nav-link" data-scroll-target="#cure-probability-model-ì™„ì¹˜-í™•ë¥ -ëª¨í˜•">ğŸ”¹ Cure Probability Model (ì™„ì¹˜ í™•ë¥  ëª¨í˜•)</a></li>
  <li><a href="#failure-time-model-ph-ëª¨í˜•" id="toc-failure-time-model-ph-ëª¨í˜•" class="nav-link" data-scroll-target="#failure-time-model-ph-ëª¨í˜•">ğŸ”¹ Failure Time Model (PH ëª¨í˜•)</a></li>
  </ul></li>
  <li><a href="#í•´ì„-ìš”ì•½" id="toc-í•´ì„-ìš”ì•½" class="nav-link" data-scroll-target="#í•´ì„-ìš”ì•½">ğŸŸ¨ í•´ì„ ìš”ì•½</a></li>
  <li><a href="#ê²°ë¡ " id="toc-ê²°ë¡ " class="nav-link" data-scroll-target="#ê²°ë¡ ">ğŸŸ¨ ê²°ë¡ </a></li>
  </ul></li>
  <li><a href="#competing-risks-transition-vs-remission" id="toc-competing-risks-transition-vs-remission" class="nav-link" data-scroll-target="#competing-risks-transition-vs-remission">ğŸŸ¥ 3. Competing Risks (transition vs remission)</a>
  <ul>
  <li><a href="#ì´ë²¤íŠ¸-íƒ€ì…-ë°-ì‹œê°„-ì „ì²˜ë¦¬" id="toc-ì´ë²¤íŠ¸-íƒ€ì…-ë°-ì‹œê°„-ì „ì²˜ë¦¬" class="nav-link" data-scroll-target="#ì´ë²¤íŠ¸-íƒ€ì…-ë°-ì‹œê°„-ì „ì²˜ë¦¬">ğŸŸ¨ ì´ë²¤íŠ¸ íƒ€ì… ë° ì‹œê°„ ì „ì²˜ë¦¬</a></li>
  <li><a href="#ì „ì²´-ì½”í˜¸íŠ¸-ëˆ„ì -ë°œìƒ-í•¨ìˆ˜cif-ì¶”ì •-ê²°ê³¼-í•´ì„" id="toc-ì „ì²´-ì½”í˜¸íŠ¸-ëˆ„ì -ë°œìƒ-í•¨ìˆ˜cif-ì¶”ì •-ê²°ê³¼-í•´ì„" class="nav-link" data-scroll-target="#ì „ì²´-ì½”í˜¸íŠ¸-ëˆ„ì -ë°œìƒ-í•¨ìˆ˜cif-ì¶”ì •-ê²°ê³¼-í•´ì„">ğŸŸ¨ ì „ì²´ ì½”í˜¸íŠ¸ ëˆ„ì  ë°œìƒ í•¨ìˆ˜(CIF) ì¶”ì • ê²°ê³¼ í•´ì„</a>
  <ul class="collapse">
  <li><a href="#ì¶”ì •ì¹˜-ë°-ë¶„ì‚°-printfit_cr-ê²°ê³¼" id="toc-ì¶”ì •ì¹˜-ë°-ë¶„ì‚°-printfit_cr-ê²°ê³¼" class="nav-link" data-scroll-target="#ì¶”ì •ì¹˜-ë°-ë¶„ì‚°-printfit_cr-ê²°ê³¼">ğŸŸª ì¶”ì •ì¹˜ ë° ë¶„ì‚° (<code>print(fit_cr)</code> ê²°ê³¼)</a></li>
  <li><a href="#ê·¸ë˜í”„-í•´ì„-1" id="toc-ê·¸ë˜í”„-í•´ì„-1" class="nav-link" data-scroll-target="#ê·¸ë˜í”„-í•´ì„-1">ğŸŸª ê·¸ë˜í”„ í•´ì„</a></li>
  <li><a href="#ì¢…í•©-í•´ì„" id="toc-ì¢…í•©-í•´ì„" class="nav-link" data-scroll-target="#ì¢…í•©-í•´ì„">ğŸŸª ì¢…í•© í•´ì„</a></li>
  </ul></li>
  <li><a href="#ê·¸ë£¹ë³„-grays-test-ì„±ë³„ì—-ë”°ë¥¸-cif-ì°¨ì´-ê²€ì •" id="toc-ê·¸ë£¹ë³„-grays-test-ì„±ë³„ì—-ë”°ë¥¸-cif-ì°¨ì´-ê²€ì •" class="nav-link" data-scroll-target="#ê·¸ë£¹ë³„-grays-test-ì„±ë³„ì—-ë”°ë¥¸-cif-ì°¨ì´-ê²€ì •">ğŸŸ¨ ê·¸ë£¹ë³„ Grayâ€™s test : ì„±ë³„ì— ë”°ë¥¸ CIF ì°¨ì´ ê²€ì •</a>
  <ul class="collapse">
  <li><a href="#ê²€ì •-ê²°ê³¼" id="toc-ê²€ì •-ê²°ê³¼" class="nav-link" data-scroll-target="#ê²€ì •-ê²°ê³¼">ğŸŸª ê²€ì • ê²°ê³¼</a></li>
  <li><a href="#cif-ì¶”ì •ì¹˜-200400600ì¼" id="toc-cif-ì¶”ì •ì¹˜-200400600ì¼" class="nav-link" data-scroll-target="#cif-ì¶”ì •ì¹˜-200400600ì¼">ğŸŸª CIF ì¶”ì •ì¹˜ (@ 200Â·400Â·600ì¼)</a></li>
  <li><a href="#ê·¸ë˜í”„-í•´ì„-2" id="toc-ê·¸ë˜í”„-í•´ì„-2" class="nav-link" data-scroll-target="#ê·¸ë˜í”„-í•´ì„-2">ğŸŸª ê·¸ë˜í”„ í•´ì„</a></li>
  <li><a href="#ê²°ë¡ -ìš”ì•½-1" id="toc-ê²°ë¡ -ìš”ì•½-1" class="nav-link" data-scroll-target="#ê²°ë¡ -ìš”ì•½-1">ğŸŸª ê²°ë¡  ìš”ì•½</a></li>
  </ul></li>
  <li><a href="#finegray-íšŒê·€ë¶„ì„-ê³µë³€ëŸ‰-íš¨ê³¼-í‰ê°€" id="toc-finegray-íšŒê·€ë¶„ì„-ê³µë³€ëŸ‰-íš¨ê³¼-í‰ê°€" class="nav-link" data-scroll-target="#finegray-íšŒê·€ë¶„ì„-ê³µë³€ëŸ‰-íš¨ê³¼-í‰ê°€">ğŸŸ¨ Fineâ€“Gray íšŒê·€ë¶„ì„ : ê³µë³€ëŸ‰ íš¨ê³¼ í‰ê°€</a>
  <ul class="collapse">
  <li><a href="#ì¶”ì •ê³„ìˆ˜-ë°-subdistribution-hazard-ratio-shr" id="toc-ì¶”ì •ê³„ìˆ˜-ë°-subdistribution-hazard-ratio-shr" class="nav-link" data-scroll-target="#ì¶”ì •ê³„ìˆ˜-ë°-subdistribution-hazard-ratio-shr">ğŸŸª ì¶”ì •ê³„ìˆ˜ ë° Subdistribution Hazard Ratio (SHR)</a></li>
  <li><a href="#ëª¨ë¸-ì í•©ë„" id="toc-ëª¨ë¸-ì í•©ë„" class="nav-link" data-scroll-target="#ëª¨ë¸-ì í•©ë„">ğŸŸª ëª¨ë¸ ì í•©ë„</a></li>
  <li><a href="#ê²°ë¡ -ë°-ë‹¤ìŒ-ë‹¨ê³„-ì œì•ˆ" id="toc-ê²°ë¡ -ë°-ë‹¤ìŒ-ë‹¨ê³„-ì œì•ˆ" class="nav-link" data-scroll-target="#ê²°ë¡ -ë°-ë‹¤ìŒ-ë‹¨ê³„-ì œì•ˆ">ğŸŸª ê²°ë¡  ë° ë‹¤ìŒ ë‹¨ê³„ ì œì•ˆ</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#bayesian-ìƒì¡´ë¶„ì„" id="toc-bayesian-ìƒì¡´ë¶„ì„" class="nav-link" data-scroll-target="#bayesian-ìƒì¡´ë¶„ì„">ğŸŸ¥ 5. Bayesian ìƒì¡´ë¶„ì„</a>
  <ul>
  <li><a href="#exponentialcox-ëª¨ë¸" id="toc-exponentialcox-ëª¨ë¸" class="nav-link" data-scroll-target="#exponentialcox-ëª¨ë¸">ğŸŸ¨ Exponentialâ€“Cox ëª¨ë¸</a>
  <ul class="collapse">
  <li><a href="#ëª¨í˜•-ì í•©-ë°-ê²°ê³¼-í™•ì¸" id="toc-ëª¨í˜•-ì í•©-ë°-ê²°ê³¼-í™•ì¸" class="nav-link" data-scroll-target="#ëª¨í˜•-ì í•©-ë°-ê²°ê³¼-í™•ì¸">ğŸŸª ëª¨í˜• ì í•© ë° ê²°ê³¼ í™•ì¸</a></li>
  <li><a href="#ê²°ë¡ -1" id="toc-ê²°ë¡ -1" class="nav-link" data-scroll-target="#ê²°ë¡ -1">ğŸŸª ê²°ë¡ </a></li>
  </ul></li>
  <li><a href="#exponentialcox-ë‚˜ì´-ì¤‘ì•™ì •ë ¬" id="toc-exponentialcox-ë‚˜ì´-ì¤‘ì•™ì •ë ¬" class="nav-link" data-scroll-target="#exponentialcox-ë‚˜ì´-ì¤‘ì•™ì •ë ¬">ğŸŸ¨ Exponentialâ€“Cox (ë‚˜ì´ ì¤‘ì•™ì •ë ¬)</a>
  <ul class="collapse">
  <li><a href="#ëª¨í˜•-ì í•©-ë°-ê²°ê³¼-í™•ì¸-1" id="toc-ëª¨í˜•-ì í•©-ë°-ê²°ê³¼-í™•ì¸-1" class="nav-link" data-scroll-target="#ëª¨í˜•-ì í•©-ë°-ê²°ê³¼-í™•ì¸-1">ğŸŸª ëª¨í˜• ì í•© ë° ê²°ê³¼ í™•ì¸</a></li>
  <li><a href="#ê²°ë¡ -2" id="toc-ê²°ë¡ -2" class="nav-link" data-scroll-target="#ê²°ë¡ -2">ğŸŸª ê²°ë¡ </a></li>
  </ul></li>
  <li><a href="#bayesian-mixture-cure-model-stan" id="toc-bayesian-mixture-cure-model-stan" class="nav-link" data-scroll-target="#bayesian-mixture-cure-model-stan">ğŸŸ¨ 5. Bayesian Mixture Cure Model (Stan)</a>
  <ul class="collapse">
  <li><a href="#ëª¨í˜•-ì í•©" id="toc-ëª¨í˜•-ì í•©" class="nav-link" data-scroll-target="#ëª¨í˜•-ì í•©">ğŸŸª ëª¨í˜• ì í•©</a></li>
  <li><a href="#íŒŒë¼ë¯¸í„°-ìš”ì•½-í•´ì„" id="toc-íŒŒë¼ë¯¸í„°-ìš”ì•½-í•´ì„" class="nav-link" data-scroll-target="#íŒŒë¼ë¯¸í„°-ìš”ì•½-í•´ì„">ğŸŸª íŒŒë¼ë¯¸í„° ìš”ì•½ í•´ì„</a>
  <ul class="collapse">
  <li><a href="#ìš”ì•½-í•´ì„" id="toc-ìš”ì•½-í•´ì„" class="nav-link" data-scroll-target="#ìš”ì•½-í•´ì„">ìš”ì•½ í•´ì„</a></li>
  <li><a href="#ìˆ˜ë ´-ì§„ë‹¨-ê²°ê³¼" id="toc-ìˆ˜ë ´-ì§„ë‹¨-ê²°ê³¼" class="nav-link" data-scroll-target="#ìˆ˜ë ´-ì§„ë‹¨-ê²°ê³¼">ìˆ˜ë ´ ì§„ë‹¨ ê²°ê³¼</a></li>
  </ul></li>
  <li><a href="#ì‚¬í›„ë¶„í¬-ì‹œê°í™”" id="toc-ì‚¬í›„ë¶„í¬-ì‹œê°í™”" class="nav-link" data-scroll-target="#ì‚¬í›„ë¶„í¬-ì‹œê°í™”">ğŸŸª ì‚¬í›„ë¶„í¬ ì‹œê°í™”</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Survival Analysis on Schizophrenia CHR</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>ido ji </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="íŒ¨í‚¤ì§€-ì„¤ì¹˜-ë°-ë¡œë”©" class="level1">
<h1>ğŸ“¦ íŒ¨í‚¤ì§€ ì„¤ì¹˜ ë° ë¡œë”©</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survival)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survminer)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cmprsk)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(smcure)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstanarm)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bayesSurv)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>filter <span class="ot">&lt;-</span> dplyr<span class="sc">::</span>filter</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>select <span class="ot">&lt;-</span> dplyr<span class="sc">::</span>select</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>path_save <span class="ot">=</span> <span class="st">"/Users/Ido/Documents/GitHub/Obsidian/â˜”ï¸Papers_Writing(á„‚á…©á†«á„†á…®á†« á„Šá…³á„€á…µ)/âœ…Currently working/ãŠ™ï¸á„Œá…©á„’á…§á†«á„‡á…§á†¼ á„‰á…¢á†¼á„Œá…©á†«á„‡á…®á†«á„‰á…¥á†¨/ë°ì´í„° ë¶„ì„/attachments"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="ë°ì´í„°-ì¤€ë¹„" class="level1">
<h1>ğŸ“Š ë°ì´í„° ì¤€ë¹„</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>path_data <span class="ot">&lt;-</span> <span class="st">"/Users/Ido/Documents/GitHub/Obsidian/â˜”ï¸Papers_Writing(á„‚á…©á†«á„†á…®á†« á„Šá…³á„€á…µ)/âœ…Currently working/ãŠ™ï¸á„Œá…©á„’á…§á†«á„‡á…§á†¼ á„‰á…¢á†¼á„Œá…©á†«á„‡á…®á†«á„‰á…¥á†¨/ë°ì´í„° ë¶„ì„/attachments/survival.csv"</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(path_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="kaplanmeier-ìƒì¡´ë¶„ì„" class="level1">
<h1>ğŸŸ¥ 1. Kaplanâ€“Meier ìƒì¡´ë¶„ì„</h1>
<section id="ì „ì²´-ê·¸ë£¹" class="level2">
<h2 class="anchored" data-anchor-id="ì „ì²´-ê·¸ë£¹">ğŸŸ¨ ì „ì²´ ê·¸ë£¹</h2>
<section id="ì¹´í”Œë€ë§ˆì´ì–´-ì í•©" class="level3">
<h3 class="anchored" data-anchor-id="ì¹´í”Œë€ë§ˆì´ì–´-ì í•©">ğŸŸª ì¹´í”Œë€â€“ë§ˆì´ì–´ ì í•©</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>fit_km1 <span class="ot">&lt;-</span> <span class="fu">survfit</span>(<span class="fu">Surv</span>(dur_transition, transition) <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="íŠ¹ì •-ì‹œì 730ì¼-ìƒì¡´ìœ¨" class="level3">
<h3 class="anchored" data-anchor-id="íŠ¹ì •-ì‹œì 730ì¼-ìƒì¡´ìœ¨">ğŸŸª íŠ¹ì • ì‹œì (730ì¼) ìƒì¡´ìœ¨</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_km1, <span class="at">times =</span> <span class="dv">730</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call: survfit(formula = Surv(dur_transition, transition) ~ 1, data = df)

 time n.risk n.event survival std.err lower 95% CI upper 95% CI
  730     19      12    0.722  0.0701        0.597        0.874</code></pre>
</div>
</div>
</section>
<section id="ì í•©ê²°ê³¼-ìš”ì•½-í•´ì„730ì¼-ì‹œì -ê¸°ì¤€" class="level3">
<h3 class="anchored" data-anchor-id="ì í•©ê²°ê³¼-ìš”ì•½-í•´ì„730ì¼-ì‹œì -ê¸°ì¤€">ğŸŸª ì í•©ê²°ê³¼ ìš”ì•½ í•´ì„(730ì¼ ì‹œì  ê¸°ì¤€)</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 21%">
<col style="width: 78%">
</colgroup>
<thead>
<tr class="header">
<th>í•­ëª©</th>
<th>ì˜ë¯¸</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>time</code></td>
<td>í‰ê°€ ì‹œì  (730ì¼ = 2ë…„)</td>
</tr>
<tr class="even">
<td><code>n.risk</code></td>
<td>í•´ë‹¹ ì‹œì ê¹Œì§€ ìƒì¡´(ì „ì´ ì•ˆ ë¨) ìƒíƒœë¡œ ê´€ì°° ì¤‘ì¸ ëŒ€ìƒ ìˆ˜</td>
</tr>
<tr class="odd">
<td><code>n.event</code></td>
<td>ì‚¬ê±´(ì „ì´) ë°œìƒ ìˆ˜</td>
</tr>
<tr class="even">
<td><code>survival</code></td>
<td>ì¶”ì • ìƒì¡´ í™•ë¥  â†’ ì•½ <strong>72.2%</strong></td>
</tr>
<tr class="odd">
<td><code>std.err</code></td>
<td>ìƒì¡´ë¥ ì˜ í‘œì¤€ ì˜¤ì°¨</td>
</tr>
<tr class="even">
<td><code>lower 95% CI</code></td>
<td>ìƒì¡´ë¥  95% ì‹ ë¢°êµ¬ê°„ í•˜í•œ = <strong>59.7%</strong></td>
</tr>
<tr class="odd">
<td><code>upper 95% CI</code></td>
<td>ìƒì¡´ë¥  95% ì‹ ë¢°êµ¬ê°„ ìƒí•œ = <strong>87.4%</strong></td>
</tr>
</tbody>
</table>
<blockquote class="blockquote">
<p><strong>CHR ìƒíƒœì¸ ê°œì¸ì´ ì¡°í˜„ë³‘ìœ¼ë¡œ ì „ì´ë˜ì§€ ì•Šê³  2ë…„(730ì¼)ê°„ ìœ ì§€ë  í™•ë¥ ì€ ì•½ 72.2%ì´ë©°, 95% ì‹ ë¢°êµ¬ê°„ì€ 59.7% ~ 87.4%ì´ë‹¤.</strong></p>
</blockquote>
</section>
<section id="ì¹´í”Œë€-ë§ˆì´ì–´-ê³¡ì„ -ë°-ì‹ ë¢°êµ¬ê°„-ì‹œê°í™”" class="level3">
<h3 class="anchored" data-anchor-id="ì¹´í”Œë€-ë§ˆì´ì–´-ê³¡ì„ -ë°-ì‹ ë¢°êµ¬ê°„-ì‹œê°í™”">ğŸŸª ì¹´í”Œë€-ë§ˆì´ì–´ ê³¡ì„  ë° ì‹ ë¢°êµ¬ê°„ ì‹œê°í™”</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsurvplot</span>(fit_km1,</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="at">conf.int =</span> <span class="cn">TRUE</span>,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="at">xlab =</span> <span class="st">"Days"</span>,</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="at">ylab =</span> <span class="st">"Transition-free Survival Probability"</span>,</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="at">title =</span> <span class="st">"KM: CHR â†’ Schizophrenia (Total)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Survival-Analysis_files/figure-html/km-overall-gg-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="ê·¸ë˜í”„-í•´ì„" class="level4">
<h4 class="anchored" data-anchor-id="ê·¸ë˜í”„-í•´ì„">ğŸ“Š ê·¸ë˜í”„ í•´ì„</h4>
<ul>
<li><strong>ë¶‰ì€ ì‹¤ì„ </strong>: Kaplan-Meier ì¶”ì • ìƒì¡´ ê³¡ì„  ( (t) )</li>
<li><strong>íšŒìƒ‰ ìŒì˜</strong>: 95% ì‹ ë¢°êµ¬ê°„</li>
<li><code>+</code> í‘œì‹œ: ê²€ì—´ëœ ì‚¬ë¡€ (ì „ì´ ì—†ì´ ê´€ì°° ì¢…ë£Œ)</li>
<li>ê³¡ì„ ì´ í‰í‰í•´ì§€ëŠ” êµ¬ê°„ì€ ì‚¬ê±´ì´ ë” ì´ìƒ ë°œìƒí•˜ì§€ ì•Šì•˜ìŒì„ ë‚˜íƒ€ëƒ„</li>
<li>ì‹œê°ì ìœ¼ë¡œë„ 730ì¼ ì‹œì ì—ì„œ ì•½ 0.72 ìˆ˜ì¤€ì˜ ìƒì¡´ í™•ë¥ ì„ í™•ì¸ ê°€ëŠ¥</li>
</ul>
</section>
</section>
<section id="ê²°ë¡ -ìš”ì•½" class="level3">
<h3 class="anchored" data-anchor-id="ê²°ë¡ -ìš”ì•½">ğŸŸª ê²°ë¡  ìš”ì•½</h3>
<table class="caption-top table">
<thead>
<tr class="header">
<th>í•­ëª©</th>
<th>ê°’</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>ìƒì¡´ í™•ë¥ </td>
<td><strong>72.2%</strong></td>
</tr>
<tr class="even">
<td>ì‚¬ê±´ ë°œìƒë¥ </td>
<td><strong>27.8%</strong></td>
</tr>
<tr class="odd">
<td>ì‹ ë¢°êµ¬ê°„ (95%)</td>
<td><strong>[59.7%, 87.4%]</strong></td>
</tr>
<tr class="even">
<td>í•´ì„</td>
<td>CHR ìƒíƒœì˜ ì•½ 72%ëŠ” 2ë…„ ë‚´ ì¡°í˜„ë³‘ìœ¼ë¡œ ì „ì´ë˜ì§€ ì•ŠìŒ</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="ì„±ë³„-ê·¸ë£¹ë³„-ìƒì¡´-ë¶„ì„-kaplanmeier-ë°-log-rank-ê²€ì •" class="level2">
<h2 class="anchored" data-anchor-id="ì„±ë³„-ê·¸ë£¹ë³„-ìƒì¡´-ë¶„ì„-kaplanmeier-ë°-log-rank-ê²€ì •">ğŸŸ¨ ì„±ë³„ ê·¸ë£¹ë³„ ìƒì¡´ ë¶„ì„: Kaplanâ€“Meier ë° Log-rank ê²€ì •</h2>
<section id="kaplanmeier-ìƒì¡´ê³¡ì„ -ì„±ë³„-ê·¸ë£¹-ë¹„êµ" class="level3">
<h3 class="anchored" data-anchor-id="kaplanmeier-ìƒì¡´ê³¡ì„ -ì„±ë³„-ê·¸ë£¹-ë¹„êµ">ğŸŸª Kaplanâ€“Meier ìƒì¡´ê³¡ì„ : ì„±ë³„ ê·¸ë£¹ ë¹„êµ</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>fit_km2 <span class="ot">&lt;-</span> <span class="fu">survfit</span>(<span class="fu">Surv</span>(dur_transition, transition) <span class="sc">~</span> sex, <span class="at">data =</span> df)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsurvplot</span>(</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  fit_km2,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">conf.int =</span> <span class="cn">TRUE</span>,</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">pval =</span> <span class="cn">TRUE</span>,</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"Days"</span>,</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">"Transition-free Survival Probability"</span>,</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">"KM: CHR â†’ Schizophrenia by Sex"</span>,</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend.title =</span> <span class="st">"Sex"</span>,</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend.labs =</span> <span class="fu">c</span>(<span class="st">"Female (0)"</span>, <span class="st">"Male (1)"</span>)</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Survival-Analysis_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<blockquote class="blockquote">
<p>Kaplanâ€“Meier ìƒì¡´ê³¡ì„ ì€ ì„±ë³„(sex)ì— ë”°ë¼ <strong>ì „ì´ ì—†ëŠ” ìƒì¡´ë¥ (Survival Probability)</strong>ì„ ì‹œê°ì ìœ¼ë¡œ ë¹„êµ. ì‹¤ì„ ì€ ìƒì¡´ ì¶”ì • ê³¡ì„ , ìŒì˜ì€ 95% ì‹ ë¢°êµ¬ê°„ì„ ì˜ë¯¸í•˜ë©°, <code>+</code> ê¸°í˜¸ëŠ” ì¤‘ë„ê²€ì—´ëœ ê´€ì¸¡ì¹˜ë¥¼ ë‚˜íƒ€ëƒ„.</p>
</blockquote>
<hr>
</section>
<section id="ì¼2ë…„-ì‹œì -ìƒì¡´ìœ¨-ë¹„êµ" class="level3">
<h3 class="anchored" data-anchor-id="ì¼2ë…„-ì‹œì -ìƒì¡´ìœ¨-ë¹„êµ">ğŸŸª 730ì¼(2ë…„) ì‹œì  ìƒì¡´ìœ¨ ë¹„êµ</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_km2, <span class="at">times =</span> <span class="dv">730</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call: survfit(formula = Surv(dur_transition, transition) ~ sex, data = df)

                sex=0 
        time       n.risk      n.event     survival      std.err lower 95% CI 
     730.000        6.000        7.000        0.643        0.114        0.454 
upper 95% CI 
       0.911 

                sex=1 
        time       n.risk      n.event     survival      std.err lower 95% CI 
    730.0000      13.0000       5.0000       0.7881       0.0852       0.6376 
upper 95% CI 
      0.9741 </code></pre>
</div>
</div>
<table class="caption-top table">
<colgroup>
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th>ì„±ë³„ (<code>sex</code>)</th>
<th>ìƒì¡´ë¥  ( <span class="math inline">\(\hat{S}(730)\)</span> )</th>
<th>í‘œì¤€ì˜¤ì°¨ (SE)</th>
<th>95% ì‹ ë¢°êµ¬ê°„</th>
<th>n.risk</th>
<th>n.event</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Female (0)</td>
<td>64.3%</td>
<td>0.114</td>
<td>[45.4%, 91.1%]</td>
<td>6</td>
<td>7</td>
</tr>
<tr class="even">
<td>Male (1)</td>
<td>78.8%</td>
<td>0.0852</td>
<td>[63.8%, 97.4%]</td>
<td>13</td>
<td>5</td>
</tr>
</tbody>
</table>
<blockquote class="blockquote">
<p><strong>í•´ì„</strong>: 2ë…„ ì‹œì ì—ì„œ ì—¬ì„±ì€ ì•½ 64.3%, ë‚¨ì„±ì€ ì•½ 78.8%ê°€ ì „ì´ ì—†ì´ ìƒì¡´. ë‚¨ì„±ì´ ë” ë†’ì€ ìƒì¡´ë¥ ì„ ë³´ì˜€ìœ¼ë‚˜, ì‹ ë¢°êµ¬ê°„ì´ ë„“ì–´ í†µê³„ì ìœ¼ë¡œ ìœ ì˜í•œ ì°¨ì´ì¸ì§€ ì¶”ê°€ ë¶„ì„ì´ í•„ìš”.</p>
</blockquote>
<hr>
</section>
<section id="log-rank-ê²€ì •-ì„±ë³„-ê°„-ìƒì¡´ê³¡ì„ -ì°¨ì´-ê²€ì •" class="level3">
<h3 class="anchored" data-anchor-id="log-rank-ê²€ì •-ì„±ë³„-ê°„-ìƒì¡´ê³¡ì„ -ì°¨ì´-ê²€ì •">ğŸŸª Log-rank ê²€ì •: ì„±ë³„ ê°„ ìƒì¡´ê³¡ì„  ì°¨ì´ ê²€ì •</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>fit_logrank <span class="ot">&lt;-</span> <span class="fu">survdiff</span>(<span class="fu">Surv</span>(dur_transition, transition) <span class="sc">~</span> sex, <span class="at">data =</span> df)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>chisq <span class="ot">&lt;-</span> fit_logrank<span class="sc">$</span>chisq</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>dfree <span class="ot">&lt;-</span> <span class="fu">length</span>(fit_logrank<span class="sc">$</span>n) <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>p_val <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">pchisq</span>(chisq, dfree)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>fit_logrank</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
survdiff(formula = Surv(dur_transition, transition) ~ sex, data = df)

       N Observed Expected (O-E)^2/E (O-E)^2/V
sex=0 26        7      5.1     0.707      1.24
sex=1 28        5      6.9     0.523      1.24

 Chisq= 1.2  on 1 degrees of freedom, p= 0.3 </code></pre>
</div>
</div>
<table class="caption-top table">
<thead>
<tr class="header">
<th>ê·¸ë£¹</th>
<th>N</th>
<th>Observed</th>
<th>Expected</th>
<th>(Oâˆ’E)Â² / E</th>
<th>(Oâˆ’E)Â² / V</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Female (0)</td>
<td>26</td>
<td>7</td>
<td>5.1</td>
<td>0.707</td>
<td>1.24</td>
</tr>
<tr class="even">
<td>Male (1)</td>
<td>28</td>
<td>5</td>
<td>6.9</td>
<td>0.523</td>
<td>1.24</td>
</tr>
</tbody>
</table>
<ul>
<li><strong>ì¹´ì´ì œê³± í†µê³„ëŸ‰</strong>: 1.2<br>
</li>
<li><strong>ììœ ë„</strong>: 1<br>
</li>
<li><strong>p-value</strong>: 0.265</li>
</ul>
<blockquote class="blockquote">
<p><strong>ê²°ë¡ </strong>: ì„±ë³„ì— ë”°ë¥¸ ìƒì¡´ê³¡ì„  ì°¨ì´ëŠ” <strong>í†µê³„ì ìœ¼ë¡œ ìœ ì˜í•˜ì§€ ì•ŠìŒ</strong> (p = 0.265 &gt; 0.05). ë”°ë¼ì„œ CHR í™˜ìì˜ ì¡°í˜„ë³‘ ì „ì´ ìƒì¡´ì‹œê°„ì€ ì„±ë³„ ê°„ ìœ ì˜ë¯¸í•œ ì°¨ì´ë¥¼ ë³´ì´ì§€ ì•ŠìŒ.</p>
</blockquote>
<hr>
</section>
<section id="ì¢…í•©-ìš”ì•½" class="level3">
<h3 class="anchored" data-anchor-id="ì¢…í•©-ìš”ì•½">ğŸŸª ì¢…í•© ìš”ì•½</h3>
<table class="caption-top table">
<thead>
<tr class="header">
<th>í•­ëª©</th>
<th>ê²°ê³¼</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>ë¶„ì„ ê¸°ë²•</td>
<td>Kaplan-Meier + Log-rank ê²€ì •</td>
</tr>
<tr class="even">
<td>ë¹„êµ ë³€ìˆ˜</td>
<td>ì„±ë³„ (<code>sex</code>)</td>
</tr>
<tr class="odd">
<td>ìƒì¡´ë¥  ì°¨ì´</td>
<td>ì—¬ì„± 64.3% vs ë‚¨ì„± 78.8%</td>
</tr>
<tr class="even">
<td>í†µê³„ì  ìœ ì˜ì„±</td>
<td>p = 0.265 (ìœ ì˜í•˜ì§€ ì•ŠìŒ)</td>
</tr>
</tbody>
</table>
<blockquote class="blockquote">
<p><em>Kaplanâ€“Meier ìƒì¡´ê³¡ì„  ë° log-rank ê²€ì • ê²°ê³¼, ì„±ë³„ì— ë”°ë¥¸ CHR í™˜ìì˜ ì¡°í˜„ë³‘ ì „ì´ ìƒì¡´ë¥ ì€ ì‹œê°ì ìœ¼ë¡œ ì°¨ì´ë¥¼ ë³´ì˜€ìœ¼ë‚˜, í†µê³„ì ìœ¼ë¡œëŠ” ìœ ì˜í•˜ì§€ ì•Šì•˜ë‹¤ (Ï‡Â² = 1.2, df = 1, p = 0.265).</em></p>
</blockquote>
</section>
</section>
</section>
<section id="mixture-cure-model-ph" class="level1">
<h1>ğŸŸ¥ 2. Mixture Cure Model (PH)</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit_cure_ph &lt;- smcure(Surv(dur_transition, transition) ~ age, </span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co">#                       cureform = ~ age,</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co">#                       model = "ph", data = df)</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co"># save(fit_cure_ph, file = file.path(path_save, "fit_cure_ph.RData"))</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="fu">file.path</span>(path_save, <span class="st">"fit_cure_ph.RData"</span>))</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="fu">printsmcure</span>(fit_cure_ph)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
smcure(formula = Surv(dur_transition, transition) ~ age, cureform = ~age, 
    data = df, model = "ph")

Cure probability model:
               Estimate  Std.Error   Z value  Pr(&gt;|Z|)
(Intercept) -3.12854012 1.90901154 -1.638827 0.1012492
age          0.09287625 0.08143941  1.140434 0.2541057


Failure time distribution model:
      Estimate Std.Error     Z value Pr(&gt;|Z|)
age -0.1238364  1.488564 -0.08319182 0.933699</code></pre>
</div>
</div>
<section id="ë¶„ì„-ê°œìš”" class="level3">
<h3 class="anchored" data-anchor-id="ë¶„ì„-ê°œìš”">ğŸŸ¨ ë¶„ì„ ê°œìš”</h3>
<p><code>smcure()</code> í•¨ìˆ˜ë¥¼ í†µí•´ <strong>PH ê¸°ë°˜ Mixture Cure Model</strong>ì„ ì í•©.</p>
<p>í•´ë‹¹ ëª¨ë¸ì€ <strong>ì¼ë¶€ í”¼í—˜ìê°€ ì‚¬ê±´(event)ì„ ì˜ì›íˆ ê²ªì§€ ì•Šì„ ìˆ˜ ìˆìŒ</strong>ì„ ë°˜ì˜í•˜ì—¬ ëª¨ì§‘ë‹¨ì„ ë‹¤ìŒ ë‘ ê·¸ë£¹ìœ¼ë¡œ ë¶„ë¦¬:</p>
<ul>
<li><strong>Cured (ì™„ì¹˜ì)</strong>: ì‚¬ê±´ ë°œìƒ ê°€ëŠ¥ì„± ì—†ìŒ</li>
<li><strong>Uncured (ë¯¸ì™„ì¹˜ì)</strong>: ì‚¬ê±´ ë°œìƒ ê°€ëŠ¥</li>
</ul>
<hr>
</section>
<section id="ìˆ˜í•™ì -ëª¨ë¸-êµ¬ì¡°" class="level3">
<h3 class="anchored" data-anchor-id="ìˆ˜í•™ì -ëª¨ë¸-êµ¬ì¡°">ğŸŸ¨ ìˆ˜í•™ì  ëª¨ë¸ êµ¬ì¡°</h3>
<p>ì „ì²´ ìƒì¡´í•¨ìˆ˜ì˜ êµ¬ì„±:</p>
<p>\[ S(t Z_i, X_i) = (Z_i) + (1 - (Z_i)) S_u(t X_i) \]</p>
<ul>
<li>\((Z_i)\) : ì¹˜ìœ  í™•ë¥  (ë¡œì§€ìŠ¤í‹± íšŒê·€)</li>
<li>\(S_u(t X_i)\): ì¹˜ìœ ë˜ì§€ ì•Šì€ ê·¸ë£¹ì˜ ìƒì¡´í•¨ìˆ˜ (Cox PH ê¸°ë°˜)</li>
</ul>
<hr>
</section>
<section id="ëª¨ë¸-ì¶”ì •-ê²°ê³¼" class="level3">
<h3 class="anchored" data-anchor-id="ëª¨ë¸-ì¶”ì •-ê²°ê³¼">ğŸŸ¨ ëª¨ë¸ ì¶”ì • ê²°ê³¼</h3>
<section id="cure-probability-model-ì™„ì¹˜-í™•ë¥ -ëª¨í˜•" class="level4">
<h4 class="anchored" data-anchor-id="cure-probability-model-ì™„ì¹˜-í™•ë¥ -ëª¨í˜•">ğŸ”¹ Cure Probability Model (ì™„ì¹˜ í™•ë¥  ëª¨í˜•)</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>ê³„ìˆ˜</th>
<th>ì¶”ì •ê°’</th>
<th>í‘œì¤€ì˜¤ì°¨</th>
<th>z ê°’</th>
<th>p ê°’</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Intercept</td>
<td>â€“3.1285</td>
<td>1.9090</td>
<td>â€“1.639</td>
<td>0.1012</td>
</tr>
<tr class="even">
<td>age</td>
<td>0.0929</td>
<td>0.0814</td>
<td>1.140</td>
<td>0.2541</td>
</tr>
</tbody>
</table>
<blockquote class="blockquote">
<p>ë‚˜ì´ê°€ ë§ì„ìˆ˜ë¡ ì™„ì¹˜ í™•ë¥ ì´ ì¦ê°€í•˜ëŠ” ê²½í–¥ì„ ë³´ì´ë‚˜ <strong>p-ê°’ì´ ìœ ì˜ìˆ˜ì¤€ 0.05ë¥¼ ì´ˆê³¼</strong>í•˜ì—¬ í†µê³„ì ìœ¼ë¡œ ìœ ì˜í•˜ì§€ ì•ŠìŒ</p>
</blockquote>
</section>
<section id="failure-time-model-ph-ëª¨í˜•" class="level4">
<h4 class="anchored" data-anchor-id="failure-time-model-ph-ëª¨í˜•">ğŸ”¹ Failure Time Model (PH ëª¨í˜•)</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>ê³„ìˆ˜</th>
<th>ì¶”ì •ê°’</th>
<th>í‘œì¤€ì˜¤ì°¨</th>
<th>z ê°’</th>
<th>p ê°’</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>age</td>
<td>â€“0.1238</td>
<td>1.4886</td>
<td>â€“0.083</td>
<td>0.9337</td>
</tr>
</tbody>
</table>
<blockquote class="blockquote">
<p>ë‚˜ì´ê°€ ë§ì„ìˆ˜ë¡ ì‚¬ê±´ ë°œìƒ ìœ„í—˜ì´ ê°ì†Œí•˜ëŠ” ê²½í–¥ì´ë‚˜, <strong>p-ê°’ì´ ë§¤ìš° í¬ë©° ìœ ì˜í•˜ì§€ ì•ŠìŒ</strong></p>
</blockquote>
<hr>
</section>
</section>
<section id="í•´ì„-ìš”ì•½" class="level3">
<h3 class="anchored" data-anchor-id="í•´ì„-ìš”ì•½">ğŸŸ¨ í•´ì„ ìš”ì•½</h3>
<ul>
<li><strong>ì™„ì¹˜ í™•ë¥ </strong>: ë‚˜ì´ì˜ ê³„ìˆ˜ëŠ” ì–‘ìˆ˜ â†’ ë‚˜ì´ê°€ ë§ì„ìˆ˜ë¡ ì™„ì¹˜ë  ê°€ëŠ¥ì„±ì´ ë†’ì•„ì§€ëŠ” ê²½í–¥. ê·¸ëŸ¬ë‚˜ í†µê³„ì ìœ¼ë¡œ ìœ ì˜í•˜ì§€ ì•ŠìŒ</li>
<li><strong>ì‚¬ê±´ ë°œìƒ ì‹œê°„</strong>: ë‚˜ì´ì˜ ê³„ìˆ˜ëŠ” ìŒìˆ˜ â†’ ë‚˜ì´ê°€ ë§ì„ìˆ˜ë¡ ì „ì´ê°€ ëŠë ¤ì§ˆ ê°€ëŠ¥ì„±. ë§ˆì°¬ê°€ì§€ë¡œ ìœ ì˜í•˜ì§€ ì•ŠìŒ</li>
<li><strong>ì „ë°˜ì  ê²°ë¡ </strong>: ë³¸ ë°ì´í„°ì—ì„œëŠ” ë‚˜ì´ê°€ ì™„ì¹˜ ì—¬ë¶€ë‚˜ ì‚¬ê±´ ë°œìƒ ì‹œê°„ì— <strong>ìœ ì˜í•œ ì˜í–¥ì„ ì£¼ì§€ ì•ŠìŒ</strong></li>
</ul>
<hr>
</section>
<section id="ê²°ë¡ " class="level3">
<h3 class="anchored" data-anchor-id="ê²°ë¡ ">ğŸŸ¨ ê²°ë¡ </h3>
<table class="caption-top table">
<colgroup>
<col style="width: 23%">
<col style="width: 25%">
<col style="width: 23%">
<col style="width: 27%">
</colgroup>
<thead>
<tr class="header">
<th>êµ¬ì„± ìš”ì†Œ</th>
<th>ë‚˜ì´(age)ì˜ íš¨ê³¼</th>
<th>ìœ ì˜ì„± (p-value)</th>
<th>í•´ì„ ìš”ì•½</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>ì™„ì¹˜ í™•ë¥ </td>
<td>ì¦ê°€ì‹œí‚¤ëŠ” ê²½í–¥ (ì–‘ì˜ ê³„ìˆ˜)</td>
<td>0.2541</td>
<td>ìœ ì˜í•˜ì§€ ì•ŠìŒ</td>
</tr>
<tr class="even">
<td>ìƒì¡´ì‹œê°„ (ì „ì´ ì‹œê°„)</td>
<td>ê°ì†Œì‹œí‚¤ëŠ” ê²½í–¥ (ìŒì˜ ê³„ìˆ˜)</td>
<td>0.9337</td>
<td>ìœ ì˜í•˜ì§€ ì•ŠìŒ</td>
</tr>
</tbody>
</table>
<blockquote class="blockquote">
<p>í˜„ì¬ ëª¨ë¸ì—ì„œëŠ” <strong>ë‚˜ì´ê°€ ì¤‘ìš”í•œ ì„¤ëª…ë³€ìˆ˜ê°€ ì•„ë‹˜</strong>ì„ ì‹œì‚¬. ë‹¤ë¥¸ ê³µë³€ëŸ‰ ì¶”ê°€, í˜¹ì€ ëª¨ë¸ ì¬ì„¤ê³„ í•„ìš”</p>
</blockquote>
<hr>
</section>
</section>
<section id="competing-risks-transition-vs-remission" class="level1">
<h1>ğŸŸ¥ 3. Competing Risks (transition vs remission)</h1>
<section id="ì´ë²¤íŠ¸-íƒ€ì…-ë°-ì‹œê°„-ì „ì²˜ë¦¬" class="level2">
<h2 class="anchored" data-anchor-id="ì´ë²¤íŠ¸-íƒ€ì…-ë°-ì‹œê°„-ì „ì²˜ë¦¬">ğŸŸ¨ ì´ë²¤íŠ¸ íƒ€ì… ë° ì‹œê°„ ì „ì²˜ë¦¬</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>event_type <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(df<span class="sc">$</span>transition <span class="sc">==</span> <span class="dv">1</span>, <span class="dv">1</span>, <span class="fu">ifelse</span>(df<span class="sc">$</span>remission <span class="sc">==</span> <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">0</span>))</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>time_to_event <span class="ot">&lt;-</span> <span class="fu">pmin</span>(df<span class="sc">$</span>dur_transition, df<span class="sc">$</span>dur_remission, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="ì „ì²´-ì½”í˜¸íŠ¸-ëˆ„ì -ë°œìƒ-í•¨ìˆ˜cif-ì¶”ì •-ê²°ê³¼-í•´ì„" class="level2">
<h2 class="anchored" data-anchor-id="ì „ì²´-ì½”í˜¸íŠ¸-ëˆ„ì -ë°œìƒ-í•¨ìˆ˜cif-ì¶”ì •-ê²°ê³¼-í•´ì„">ğŸŸ¨ ì „ì²´ ì½”í˜¸íŠ¸ ëˆ„ì  ë°œìƒ í•¨ìˆ˜(CIF) ì¶”ì • ê²°ê³¼ í•´ì„</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>fit_cr <span class="ot">&lt;-</span> <span class="fu">cuminc</span>(<span class="at">ftime =</span> df<span class="sc">$</span>time_to_event, <span class="at">fstatus =</span> df<span class="sc">$</span>event_type)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ê²°ê³¼ ì¶œë ¥</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit_cr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Estimates and Variances:
$est
          200        400       600
1 1 0.1402103 0.16731701 0.2793472
1 2 0.0000000 0.07369626 0.2306753

$var
            200         400         600
1 1 0.002518007 0.003098538 0.005160333
1 2 0.000000000 0.001723953 0.005632103</code></pre>
</div>
</div>
<section id="ì¶”ì •ì¹˜-ë°-ë¶„ì‚°-printfit_cr-ê²°ê³¼" class="level3">
<h3 class="anchored" data-anchor-id="ì¶”ì •ì¹˜-ë°-ë¶„ì‚°-printfit_cr-ê²°ê³¼">ğŸŸª ì¶”ì •ì¹˜ ë° ë¶„ì‚° (<code>print(fit_cr)</code> ê²°ê³¼)</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 16%">
<col style="width: 25%">
<col style="width: 17%">
<col style="width: 23%">
<col style="width: 17%">
</colgroup>
<thead>
<tr class="header">
<th>ì‹œê°„ (ì¼)</th>
<th>CIF(Transition)</th>
<th>ë¶„ì‚° (var)</th>
<th>CIF(Remission)</th>
<th>ë¶„ì‚° (var)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>200</strong></td>
<td>0.1402</td>
<td>0.002518</td>
<td>0.0000</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td><strong>400</strong></td>
<td>0.1673</td>
<td>0.003099</td>
<td>0.0737</td>
<td>0.001724</td>
</tr>
<tr class="odd">
<td><strong>600</strong></td>
<td>0.2793</td>
<td>0.005160</td>
<td>0.2307</td>
<td>0.005632</td>
</tr>
</tbody>
</table>
<blockquote class="blockquote">
<p>â€“ <strong>CIF(Transition)</strong>: ì¡°í˜„ë³‘ ì „ì´ ì‚¬ê±´ì˜ ëˆ„ì  ë°œìƒ í™•ë¥ <br>
â€“ <strong>CIF(Remission)</strong>: ê´€í•´ ì‚¬ê±´ì˜ ëˆ„ì  ë°œìƒ í™•ë¥ <br>
â€“ <strong>ë¶„ì‚°(var)</strong>: ê° ì¶”ì •ì¹˜ì˜ ë¶ˆí™•ì‹¤ì„±(variance)</p>
</blockquote>
</section>
<section id="ê·¸ë˜í”„-í•´ì„-1" class="level3">
<h3 class="anchored" data-anchor-id="ê·¸ë˜í”„-í•´ì„-1">ğŸŸª ê·¸ë˜í”„ í•´ì„</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit_cr,</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="at">xlab =</span> <span class="st">"Days"</span>,</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="at">ylab =</span> <span class="st">"Cumulative Incidence"</span>,</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="at">col =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>),</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="at">lty =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"bottomright"</span>,</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Transition"</span>, <span class="st">"Remission"</span>),</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a><span class="at">col =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>),</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a><span class="at">lty =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a><span class="at">bty =</span> <span class="st">"n"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Survival-Analysis_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><strong>íŒŒë€ ì‹¤ì„ </strong>: ì „ì´(Transition)ì˜ CIF<br>
</li>
<li><strong>ë¹¨ê°„ ì ì„ </strong>: ê´€í•´(Remission)ì˜ CIF<br>
</li>
<li>ì‹œê°„ ê²½ê³¼ì— ë”°ë¼ ë‘ ê³¡ì„  ëª¨ë‘ ìƒìŠ¹<br>
</li>
<li>600ì¼ ì‹œì  ì „ì´ ì•½ <strong>28%</strong>, ê´€í•´ ì•½ <strong>23%</strong></li>
</ul>
</section>
<section id="ì¢…í•©-í•´ì„" class="level3">
<h3 class="anchored" data-anchor-id="ì¢…í•©-í•´ì„">ğŸŸª ì¢…í•© í•´ì„</h3>
<ol type="1">
<li><p><strong>ì´ˆê¸°(â‰¤200ì¼)</strong><br>
â€“ ì „ì´ ì‚¬ê±´ì´ ë¨¼ì € ë°œìƒí•´ CIF(Transition) â‰ˆ <strong>14%</strong>, ê´€í•´ëŠ” ê±°ì˜ 0%</p></li>
<li><p><strong>ì¤‘ê¸°(200â€“400ì¼)</strong><br>
â€“ ì „ì´ ì•½ <strong>17%</strong> â†’ ê´€í•´ ì•½ <strong>7%</strong></p></li>
<li><p><strong>í›„ê¸°(400â€“600ì¼)</strong><br>
â€“ ì „ì´ ì•½ <strong>28%</strong>, ê´€í•´ ì•½ <strong>23%</strong></p></li>
<li><p><strong>ë¹„êµ</strong><br>
â€“ ì „ì´ ìœ„í—˜ì´ ê´€í•´ ìœ„í—˜ë³´ë‹¤ ë‹¤ì†Œ ë†’ê²Œ ë‚˜íƒ€ë‚˜ë‚˜, í° ì°¨ì´ëŠ” ì•„ë‹˜</p></li>
</ol>
<blockquote class="blockquote">
<p><strong>ì„ìƒì  ì‹œì‚¬ì </strong>:<br>
â€“ CHR í™˜ìì—ì„œ ì¡°í˜„ë³‘ ì „ì´ì™€ ê´€í•´ê°€ ëª¨ë‘ ì‹œê°„ì´ ì§€ë‚¨ì— ë”°ë¼ ì˜ë¯¸ ìˆê²Œ ë°œìƒ<br>
â€“ 2ë…„(â‰ˆ730ì¼)ê¹Œì§€ ì „ì´ ìœ„í—˜(â‰ˆ28%)ì´ ê´€í•´ ìœ„í—˜(â‰ˆ23%)ë³´ë‹¤ ì•½ê°„ ë†’ìŒ</p>
</blockquote>
</section>
</section>
<section id="ê·¸ë£¹ë³„-grays-test-ì„±ë³„ì—-ë”°ë¥¸-cif-ì°¨ì´-ê²€ì •" class="level2">
<h2 class="anchored" data-anchor-id="ê·¸ë£¹ë³„-grays-test-ì„±ë³„ì—-ë”°ë¥¸-cif-ì°¨ì´-ê²€ì •">ğŸŸ¨ ê·¸ë£¹ë³„ Grayâ€™s test : ì„±ë³„ì— ë”°ë¥¸ CIF ì°¨ì´ ê²€ì •</h2>
<section id="ê²€ì •-ê²°ê³¼" class="level3">
<h3 class="anchored" data-anchor-id="ê²€ì •-ê²°ê³¼">ğŸŸª ê²€ì • ê²°ê³¼</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>fit_group <span class="ot">&lt;-</span> <span class="fu">cuminc</span>(<span class="at">ftime =</span> df<span class="sc">$</span>time_to_event,</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="at">fstatus =</span> df<span class="sc">$</span>event_type,</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="at">group =</span> df<span class="sc">$</span>sex)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit_group)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Tests:
       stat        pv df
1 1.2464320 0.2642350  1
2 0.1342923 0.7140225  1
Estimates and Variances:
$est
          200        400       600
0 1 0.2206478 0.22064777 0.3604504
1 1 0.0728022 0.11940738 0.2126177
0 2 0.0000000 0.05566802 0.3434970
1 2 0.0000000 0.08830455 0.1881728

$var
            200         400         600
0 1 0.008348535 0.008348535 0.014804202
1 1 0.002554794 0.004487907 0.007717517
0 2 0.000000000 0.003141523 0.030580351
1 2 0.000000000 0.003731951 0.007719307</code></pre>
</div>
</div>
<table class="caption-top table">
<thead>
<tr class="header">
<th>ì‚¬ê±´ íƒ€ì…</th>
<th>stat</th>
<th>p-value</th>
<th>df</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>1 (ì „í™˜)</strong></td>
<td>1.2464</td>
<td>0.2642</td>
<td>1</td>
</tr>
<tr class="even">
<td><strong>2 (ê´€í•´)</strong></td>
<td>0.1343</td>
<td>0.7140</td>
<td>1</td>
</tr>
</tbody>
</table>
<blockquote class="blockquote">
<p><strong>í•´ì„:</strong> ë‘ ì‚¬ê±´ ëª¨ë‘ <strong>p &gt; 0.05</strong> ì´ë¯€ë¡œ<br>
â€œë‚¨ vs ì—¬â€ ê·¸ë£¹ ê°„ ëˆ„ì ë°œìƒê³¡ì„ (CIF)ì— <strong>í†µê³„ì ìœ¼ë¡œ ìœ ì˜í•œ ì°¨ì´ ì—†ìŒ</strong>.</p>
</blockquote>
</section>
<section id="cif-ì¶”ì •ì¹˜-200400600ì¼" class="level3">
<h3 class="anchored" data-anchor-id="cif-ì¶”ì •ì¹˜-200400600ì¼">ğŸŸª CIF ì¶”ì •ì¹˜ (@ 200Â·400Â·600ì¼)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit_group)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Tests:
       stat        pv df
1 1.2464320 0.2642350  1
2 0.1342923 0.7140225  1
Estimates and Variances:
$est
          200        400       600
0 1 0.2206478 0.22064777 0.3604504
1 1 0.0728022 0.11940738 0.2126177
0 2 0.0000000 0.05566802 0.3434970
1 2 0.0000000 0.08830455 0.1881728

$var
            200         400         600
0 1 0.008348535 0.008348535 0.014804202
1 1 0.002554794 0.004487907 0.007717517
0 2 0.000000000 0.003141523 0.030580351
1 2 0.000000000 0.003731951 0.007719307</code></pre>
</div>
</div>
<table class="caption-top table">
<thead>
<tr class="header">
<th>ê·¸ë£¹(sex)</th>
<th>ì‚¬ê±´ íƒ€ì…</th>
<th>200ì¼</th>
<th>400ì¼</th>
<th>600ì¼</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>0</strong></td>
<td>ì „í™˜ (1)</td>
<td>0.2206</td>
<td>0.2206</td>
<td>0.3605</td>
</tr>
<tr class="even">
<td><strong>1</strong></td>
<td>ì „í™˜ (1)</td>
<td>0.0728</td>
<td>0.1194</td>
<td>0.2126</td>
</tr>
<tr class="odd">
<td><strong>0</strong></td>
<td>ê´€í•´ (2)</td>
<td>0.0000</td>
<td>0.0557</td>
<td>0.3435</td>
</tr>
<tr class="even">
<td><strong>1</strong></td>
<td>ê´€í•´ (2)</td>
<td>0.0000</td>
<td>0.0883</td>
<td>0.1882</td>
</tr>
</tbody>
</table>
<blockquote class="blockquote">
<p><strong>í•´ì„:</strong><br>
- ê·¸ë£¹ 0(ì˜ˆ: ë‚¨ì„±)ì€ 600ì¼ ì‹œì  ì „í™˜ â‰ˆ36.0%, ê´€í•´ â‰ˆ34.4%<br>
- ê·¸ë£¹ 1(ì˜ˆ: ì—¬ì„±)ì€ 600ì¼ ì‹œì  ì „í™˜ â‰ˆ21.3%, ê´€í•´ â‰ˆ18.8%<br>
ê·¸ëŸ¬ë‚˜ <strong>Grayâ€™s testì—ì„œ ìœ ì˜í•˜ì§€ ì•Šì•˜ìœ¼ë¯€ë¡œ</strong><br>
ì´ ì°¨ì´ëŠ” <strong>í‘œë³¸ ì˜¤ì°¨</strong>ë‚˜ <strong>ìš°ì—°</strong>ì¼ ê°€ëŠ¥ì„±ì´ ë†’ìŒ.</p>
</blockquote>
</section>
<section id="ê·¸ë˜í”„-í•´ì„-2" class="level3">
<h3 class="anchored" data-anchor-id="ê·¸ë˜í”„-í•´ì„-2">ğŸŸª ê·¸ë˜í”„ í•´ì„</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit_group,</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="at">xlab =</span> <span class="st">"Days"</span>,</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="at">ylab =</span> <span class="st">"Cumulative Incidence"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Survival-Analysis_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><strong>Solid line (0 1)</strong>: <code>sex = 0 (Female)</code>ì˜ <strong>Transition</strong> ëˆ„ì ë°œìƒë¥ <br>
</li>
<li><strong>Dashed line (1 1)</strong>: <code>sex = 1 (Male)</code>ì˜ <strong>Transition</strong> ëˆ„ì ë°œìƒë¥ <br>
</li>
<li><strong>Dotted line (0 2)</strong>: <code>sex = 0 (Female)</code>ì˜ <strong>Remission</strong> ëˆ„ì ë°œìƒë¥ <br>
</li>
<li><strong>Dotdash line (1 2)</strong>: <code>sex = 1 (Male)</code>ì˜ <strong>Remission</strong> ëˆ„ì ë°œìƒë¥ </li>
</ul>
<blockquote class="blockquote">
<p><strong>ì£¼ìš” ê´€ì°°ì </strong><br>
- <strong>Female (solid)</strong> ì „ì´ ê³¡ì„ ì´ <strong>Male (dashed)</strong> ì „ì´ ê³¡ì„ ë³´ë‹¤ ì „ êµ¬ê°„ì—ì„œ ë†’ì•„, ì—¬ì„± ê·¸ë£¹ì˜ ì „ì´ ìœ„í—˜ì´ ë‹¤ì†Œ ë†’ê²Œ ë‚˜íƒ€ë‚¨<br>
- <strong>Female (dotted)</strong> ê´€í•´ ê³¡ì„ ë„ <strong>Male (dotdash)</strong> ê³¡ì„ ë³´ë‹¤ ë†’ì•„, ê´€í•´ ë°œìƒ ì—­ì‹œ ì—¬ì„±ì—ì„œ ë” ë¹ ë¥´ê²Œ ì¶•ì ë¨<br>
- ì „ì²´ì ìœ¼ë¡œ ë‘ ê·¸ë£¹ ê°„ ì°¨ì´ëŠ” í¬ì§€ ì•Šìœ¼ë‚˜, ì—¬ì„±ì—ì„œ ì•½ê°„ ë” ë†’ì€ ëˆ„ì ë°œìƒë¥  ê²½í–¥ ê´€ì°°</p>
</blockquote>
<blockquote class="blockquote">
<p><strong>ì„ìƒì  ì‹œì‚¬ì </strong><br>
ì—¬ì„± ê·¸ë£¹ì—ì„œ ì¡°í˜„ë³‘ ì „ì´Â·ê´€í•´ê°€ ë‹¤ì†Œ ë¹ ë¥´ê²Œ ëˆ„ì ë˜ë‚˜, Grayâ€™s test ê²°ê³¼ í†µê³„ì ìœ¼ë¡œ ìœ ì˜í•˜ì§€ ì•Šì•˜ìœ¼ë¯€ë¡œ<br>
<strong>ì¶”ê°€ í‘œë³¸ í™•ì¥</strong> ë˜ëŠ” <strong>ë‹¤ë³€ëŸ‰ Fineâ€“Gray ëª¨ë¸</strong>ì„ í†µí•´ ì°¨ì´ì˜ ìœ ì˜ì„±ì„ ì¬í™•ì¸í•  í•„ìš”ê°€ ìˆìŒ.</p>
</blockquote>
</section>
<section id="ê²°ë¡ -ìš”ì•½-1" class="level3">
<h3 class="anchored" data-anchor-id="ê²°ë¡ -ìš”ì•½-1">ğŸŸª ê²°ë¡  ìš”ì•½</h3>
<ol type="1">
<li><strong>ì„±ë³„ì— ë”°ë¥¸ ì „í™˜Â·ê´€í•´ ëˆ„ì ìœ„í—˜ ì°¨ì´ ì—†ìŒ</strong><br>
(ì „í™˜: p=0.264, ê´€í•´: p=0.714)</li>
<li><strong>ì¶”ì •ì¹˜ ì°¨ì´ëŠ” í†µê³„ì  ìœ ì˜ì„± ì—†ìŒ</strong> â†’ ì„ìƒì  ê²°ë¡ ìœ¼ë¡œëŠ” ì œí•œì </li>
</ol>
</section>
</section>
<section id="finegray-íšŒê·€ë¶„ì„-ê³µë³€ëŸ‰-íš¨ê³¼-í‰ê°€" class="level2">
<h2 class="anchored" data-anchor-id="finegray-íšŒê·€ë¶„ì„-ê³µë³€ëŸ‰-íš¨ê³¼-í‰ê°€">ğŸŸ¨ Fineâ€“Gray íšŒê·€ë¶„ì„ : ê³µë³€ëŸ‰ íš¨ê³¼ í‰ê°€</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="sc">~</span> age <span class="sc">+</span> sex, <span class="at">data =</span> df)[, <span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>fit_fg <span class="ot">&lt;-</span> <span class="fu">crr</span>(<span class="at">ftime =</span> df<span class="sc">$</span>time_to_event,</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="at">fstatus =</span> df<span class="sc">$</span>event_type,</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="at">cov1 =</span> X,</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="at">failcode =</span> <span class="dv">1</span>,</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="at">cencode =</span> <span class="dv">0</span>)</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_fg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Competing Risks Regression

Call:
crr(ftime = df$time_to_event, fstatus = df$event_type, cov1 = X, 
    failcode = 1, cencode = 0)

       coef exp(coef) se(coef)      z p-value
age  0.0211     1.021   0.0437  0.483    0.63
sex -0.5886     0.555   0.6161 -0.955    0.34

    exp(coef) exp(-coef)  2.5% 97.5%
age     1.021      0.979 0.937  1.11
sex     0.555      1.801 0.166  1.86

Num. cases = 54
Pseudo Log-likelihood = -43.1 
Pseudo likelihood ratio test = 1.39  on 2 df,</code></pre>
</div>
</div>
<section id="ì¶”ì •ê³„ìˆ˜-ë°-subdistribution-hazard-ratio-shr" class="level3">
<h3 class="anchored" data-anchor-id="ì¶”ì •ê³„ìˆ˜-ë°-subdistribution-hazard-ratio-shr">ğŸŸª ì¶”ì •ê³„ìˆ˜ ë° Subdistribution Hazard Ratio (SHR)</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th>ë³€ìˆ˜</th>
<th>coef</th>
<th>exp(coef) (SHR)</th>
<th>se(coef)</th>
<th>z</th>
<th>p-value</th>
<th>95% CI (SHR)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>age</strong></td>
<td>0.0211</td>
<td>1.021</td>
<td>0.0437</td>
<td>0.483</td>
<td>0.630</td>
<td>[0.937, 1.110]</td>
</tr>
<tr class="even">
<td><strong>sex</strong></td>
<td>â€“0.5886</td>
<td>0.555</td>
<td>0.6161</td>
<td>â€“0.955</td>
<td>0.340</td>
<td>[0.166, 1.860]</td>
</tr>
</tbody>
</table>
<blockquote class="blockquote">
<p><strong>í•´ì„</strong></p>
<ul>
<li><strong>age</strong>: ë‚˜ì´ê°€ í•œ ë‹¨ìœ„ ì¦ê°€í•  ë•Œ ì „ì´(<code>failcode = 1</code>)ì˜ ëˆ„ì ìœ„í—˜ì´ ì•½ 2.1% ì¦ê°€(SHR = 1.021)í•˜ë‚˜, p = 0.63ìœ¼ë¡œ í†µê³„ì ìœ¼ë¡œ ìœ ì˜í•˜ì§€ ì•ŠìŒ.</li>
<li><strong>sex</strong> (<code>sex = 1</code> vs <code>0</code>): ë‚¨ì„±ì˜ ì „ì´ ëˆ„ì ìœ„í—˜ì´ ì—¬ì„± ëŒ€ë¹„ ì•½ 44.5% ê°ì†Œ(SHR = 0.555)í•˜ë‚˜, p = 0.34ìœ¼ë¡œ ìœ ì˜í•˜ì§€ ì•ŠìŒ.</li>
</ul>
</blockquote>
</section>
<section id="ëª¨ë¸-ì í•©ë„" class="level3">
<h3 class="anchored" data-anchor-id="ëª¨ë¸-ì í•©ë„">ğŸŸª ëª¨ë¸ ì í•©ë„</h3>
<ul>
<li><strong>Pseudo likelihood ratio test</strong> = 1.39 on 2 df (p &gt; 0.05) â†’ ëª¨ë¸ì— í¬í•¨ëœ <code>age</code>, <code>sex</code> ê³µë³€ëŸ‰ ì „ì²´ê°€ ìœ ì˜ë¯¸í•œ ì„¤ëª…ë ¥ì„ ê°–ì§€ ì•ŠìŒ</li>
<li><strong>ì´ ê´€ì¸¡ì¹˜ ìˆ˜</strong> = 54</li>
</ul>
</section>
<section id="ê²°ë¡ -ë°-ë‹¤ìŒ-ë‹¨ê³„-ì œì•ˆ" class="level3">
<h3 class="anchored" data-anchor-id="ê²°ë¡ -ë°-ë‹¤ìŒ-ë‹¨ê³„-ì œì•ˆ">ğŸŸª ê²°ë¡  ë° ë‹¤ìŒ ë‹¨ê³„ ì œì•ˆ</h3>
<blockquote class="blockquote">
<h3 id="í˜„ì¬-ê²°ê³¼-age-sex-ëª¨ë‘-ì „ì´-ì‚¬ê±´ì˜-subdistribution-hazardì—-ìœ ì˜í•œ-ì˜í–¥-ì—†ìŒ" class="anchored"><strong>í˜„ì¬ ê²°ê³¼</strong>: <code>age</code>, <code>sex</code> ëª¨ë‘ ì „ì´ ì‚¬ê±´ì˜ subdistribution hazardì— <strong>ìœ ì˜í•œ ì˜í–¥ ì—†ìŒ</strong></h3>
</blockquote>
</section>
</section>
</section>
<section id="bayesian-ìƒì¡´ë¶„ì„" class="level1">
<h1>ğŸŸ¥ 5. Bayesian ìƒì¡´ë¶„ì„</h1>
<section id="exponentialcox-ëª¨ë¸" class="level2">
<h2 class="anchored" data-anchor-id="exponentialcox-ëª¨ë¸">ğŸŸ¨ Exponentialâ€“Cox ëª¨ë¸</h2>
<section id="ëª¨í˜•-ì í•©-ë°-ê²°ê³¼-í™•ì¸" class="level3">
<h3 class="anchored" data-anchor-id="ëª¨í˜•-ì í•©-ë°-ê²°ê³¼-í™•ì¸">ğŸŸª ëª¨í˜• ì í•© ë° ê²°ê³¼ í™•ì¸</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. íŒ¨í‚¤ì§€ ë¡œë“œ</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(brms)      <span class="co"># Bayesian ëª¨ë¸ë§ (HMC)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading 'brms' package (version 2.22.0). Useful instructions
can be found by typing help('brms'). A more detailed introduction
to the package is available through vignette('brms_overview').</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'brms'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:rstanarm':

    dirichlet, exponential, get_y, lasso, ngrps</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:survival':

    kidney</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:stats':

    ar</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survival)  <span class="co"># Surv ê°ì²´</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(loo)       <span class="co"># LOO-CV, WAIC</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>This is loo version 2.8.0</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>- Online documentation and vignettes at mc-stan.org/loo</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>- As of v2.0.0 loo defaults to 1 core but we recommend using as many as possible. Use the 'cores' argument or set options(mc.cores = NUM_CORES) for an entire session. </code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. ë°ì´í„° ì¤€ë¹„</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>time_years <span class="ot">&lt;-</span> df<span class="sc">$</span>time_to_event <span class="sc">/</span> <span class="dv">365</span>  </span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>example_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">age    =</span> df<span class="sc">$</span>age,</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">time   =</span> df<span class="sc">$</span>time_years,</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">status =</span> <span class="fu">as.integer</span>(df<span class="sc">$</span>transition)</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. ëª¨ë¸ ê³µì‹ ì •ì˜</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>surv_formula <span class="ot">&lt;-</span> <span class="fu">bf</span>(time <span class="sc">|</span> <span class="fu">cens</span>(status) <span class="sc">~</span> age)</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. ì‚¬ì „ë¶„í¬ ì„¤ì •</span></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>priors <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(-8, 2)"</span>, <span class="at">class =</span> <span class="st">"Intercept"</span>),</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(0.07, 0.03)"</span>, <span class="at">class =</span> <span class="st">"b"</span>, <span class="at">coef =</span> <span class="st">"age"</span>)</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. ëª¨ë¸ ì í•©</span></span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a><span class="co"># fit_surv_bayes &lt;- brm(</span></span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a><span class="co">#   formula = surv_formula,</span></span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a><span class="co">#   family  = brms::exponential(),</span></span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a><span class="co">#   data    = example_data,</span></span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a><span class="co">#   prior   = priors,</span></span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a><span class="co">#   iter    = 2000,</span></span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a><span class="co">#   warmup  = 500,</span></span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a><span class="co">#   chains  = 4,</span></span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a><span class="co">#   cores   = 4,</span></span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a><span class="co">#   seed    = 42</span></span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a><span class="co"># save(fit_surv_bayes, file = file.path(path_save, "fit_surv_bayes.RData"))</span></span>
<span id="cb35-33"><a href="#cb35-33" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="fu">file.path</span>(path_save, <span class="st">"fit_surv_bayes.RData"</span>))</span>
<span id="cb35-34"><a href="#cb35-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-35"><a href="#cb35-35" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. ê²°ê³¼ í™•ì¸</span></span>
<span id="cb35-36"><a href="#cb35-36" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_surv_bayes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: exponential 
  Links: mu = log 
Formula: time | cens(status) ~ age 
   Data: example_data (Number of observations: 54) 
  Draws: 4 chains, each with iter = 2000; warmup = 500; thin = 1;
         total post-warmup draws = 6000

Regression Coefficients:
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept    -0.20      0.53    -1.27     0.82 1.00     5652     4244
age           0.02      0.02    -0.02     0.06 1.00     4986     4043

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
<table class="caption-top">
<tbody>
</tbody>
</table>
<table class="caption-top table">
<colgroup>
<col style="width: 39%">
<col style="width: 17%">
<col style="width: 17%">
<col style="width: 24%">
</colgroup>
<thead>
<tr class="header">
<th>íŒŒë¼ë¯¸í„°</th>
<th>Estimate</th>
<th>95% CrI</th>
<th>í•´ì„</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Intercept</strong></td>
<td>â€“0.20</td>
<td>[â€“1.27, 0.82]</td>
<td>age = 0 (ì˜ˆ: 0ì„¸)ì—ì„œì˜ <strong>ê¸°ëŒ€ log-ìƒì¡´ì‹œê°„</strong> = â€“0.20</td>
</tr>
<tr class="even">
<td>â†’ <span class="math inline">\(\mu = e^{-0.20}\approx 0.82\)</span>ë…„</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td><strong>age</strong></td>
<td>0.02</td>
<td>[â€“0.02, 0.06]</td>
<td>ì—°ë ¹ì´ 1ë…„ ì¦ê°€í•  ë•Œ <strong>ê¸°ëŒ€ log-ìƒì¡´ì‹œê°„</strong>ì´ +0.02 ì¦ê°€</td>
</tr>
<tr class="even">
<td>â†’ ìƒì¡´ì‹œê°„ ì•½ 2% ì¦ê°€, í•´ì €ë“œ ì•½ 2% ê°ì†Œ (<span class="math inline">\(\mathrm{HR}=e^{-0.02}\approx0.98\)</span>)</td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<ul>
<li><strong>Credible Interval</strong>ì— 0ì„ í¬í•¨í•˜ë¯€ë¡œ, age íš¨ê³¼ëŠ” <strong>í†µê³„ì ìœ¼ë¡œ ìœ ì˜í•˜ì§€ ì•ŠìŒ</strong></li>
<li><strong>Rhat â‰ˆ 1.00</strong>, <strong>Bulk_ESS/Tail_ESS â‰« 200</strong>: MCMC ìˆ˜ë ´ ì–‘í˜¸, ìœ íš¨í‘œë³¸ ì¶©ë¶„</li>
</ul>
</section>
<section id="ê²°ë¡ -1" class="level3">
<h3 class="anchored" data-anchor-id="ê²°ë¡ -1">ğŸŸª ê²°ë¡ </h3>
<ol type="1">
<li>ì—°ë ¹ì´ í•œ ì‚´ ë§ì•„ì§ˆìˆ˜ë¡ ë°œë³‘ê¹Œì§€ì˜ ê¸°ëŒ€ìƒì¡´ì‹œê°„ì´ ì•½ 2% ëŠ˜ì–´ë‚˜ëŠ”(ìœ„í—˜ 2% ê°ì†Œ) ê²½í–¥ì´ ê´€ì°°ë˜ë‚˜, 95% CrIì— 0ì´ í¬í•¨ë˜ì–´ <strong>ìœ ì˜ë¯¸í•œ íš¨ê³¼</strong>ë¼ ë‹¨ì •í•  ìˆ˜ ì—†ìŒ</li>
<li>age = 0 ê¸°ì¤€ì˜ í•´ì„ì€ í˜„ì‹¤ì ì´ì§€ ì•Šìœ¼ë¯€ë¡œ, <strong>ageë¥¼ ì¤‘ì•™ì •ë ¬(center)</strong> í•œ ë³€í˜• ëª¨ë¸ì„ ê³ ë ¤í•˜ë©´ Interceptë¥¼ â€œí‰ê· ì—°ë ¹ì—ì„œì˜ ê¸°ëŒ€ìƒì¡´ì‹œê°„â€ìœ¼ë¡œ ì§ê´€ì  í•´ì„ ê°€ëŠ¥</li>
</ol>
<hr>
</section>
</section>
<section id="exponentialcox-ë‚˜ì´-ì¤‘ì•™ì •ë ¬" class="level2">
<h2 class="anchored" data-anchor-id="exponentialcox-ë‚˜ì´-ì¤‘ì•™ì •ë ¬">ğŸŸ¨ Exponentialâ€“Cox (ë‚˜ì´ ì¤‘ì•™ì •ë ¬)</h2>
<section id="ëª¨í˜•-ì í•©-ë°-ê²°ê³¼-í™•ì¸-1" class="level3">
<h3 class="anchored" data-anchor-id="ëª¨í˜•-ì í•©-ë°-ê²°ê³¼-í™•ì¸-1">ğŸŸª ëª¨í˜• ì í•© ë° ê²°ê³¼ í™•ì¸</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. age ì¤‘ì•™ì •ë ¬</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>age_c <span class="ot">&lt;-</span> df<span class="sc">$</span>age <span class="sc">-</span> <span class="fu">mean</span>(df<span class="sc">$</span>age)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. ë°ì´í„° ì¤€ë¹„</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>example_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">age_c  =</span> df<span class="sc">$</span>age_c,</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">time   =</span> df<span class="sc">$</span>time_to_event <span class="sc">/</span> <span class="dv">365</span>,</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">status =</span> <span class="fu">as.integer</span>(df<span class="sc">$</span>transition)</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. ëª¨ë¸ ê³µì‹ ì •ì˜</span></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>surv_formula <span class="ot">&lt;-</span> <span class="fu">bf</span>(time <span class="sc">|</span> <span class="fu">cens</span>(status) <span class="sc">~</span> age_c)</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. ì‚¬ì „ë¶„í¬ ì„¤ì •</span></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>priors <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(-8, 2)"</span>, <span class="at">class =</span> <span class="st">"Intercept"</span>),</span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(0.07, 0.03)"</span>, <span class="at">class =</span> <span class="st">"b"</span>, <span class="at">coef =</span> <span class="st">"age_c"</span>)</span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. ëª¨ë¸ ì í•©</span></span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a><span class="co"># fit_surv_bayes_2 &lt;- brm(</span></span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a><span class="co">#   formula = surv_formula,</span></span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a><span class="co">#   family  = brms::exponential(),</span></span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a><span class="co">#   data    = example_data,</span></span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a><span class="co">#   prior   = priors,</span></span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a><span class="co">#   iter    = 2000,</span></span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a><span class="co">#   warmup  = 500,</span></span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a><span class="co">#   chains  = 4,</span></span>
<span id="cb37-29"><a href="#cb37-29" aria-hidden="true" tabindex="-1"></a><span class="co">#   cores   = 4,</span></span>
<span id="cb37-30"><a href="#cb37-30" aria-hidden="true" tabindex="-1"></a><span class="co">#   seed    = 42</span></span>
<span id="cb37-31"><a href="#cb37-31" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb37-32"><a href="#cb37-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-33"><a href="#cb37-33" aria-hidden="true" tabindex="-1"></a><span class="co"># save(fit_surv_bayes_2, file = file.path(path_save, "fit_surv_bayes_2.RData"))</span></span>
<span id="cb37-34"><a href="#cb37-34" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="fu">file.path</span>(path_save, <span class="st">"fit_surv_bayes_2.RData"</span>))</span>
<span id="cb37-35"><a href="#cb37-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-36"><a href="#cb37-36" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. ê²°ê³¼ í™•ì¸</span></span>
<span id="cb37-37"><a href="#cb37-37" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_surv_bayes_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: exponential 
  Links: mu = log 
Formula: time | cens(status) ~ age_c 
   Data: example_data (Number of observations: 54) 
  Draws: 4 chains, each with iter = 2000; warmup = 500; thin = 1;
         total post-warmup draws = 6000

Regression Coefficients:
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept     0.25      0.15    -0.04     0.55 1.00     4468     3909
age_c         0.02      0.02    -0.02     0.06 1.00     5357     4078

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
<table class="caption-top table">
<colgroup>
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 54%">
</colgroup>
<thead>
<tr class="header">
<th>íŒŒë¼ë¯¸í„°</th>
<th>Estimate</th>
<th>95% Credible Interval</th>
<th>í•´ì„</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Intercept</strong></td>
<td>0.25</td>
<td>[â€“0.04, 0.55]</td>
<td><code>age_c = 0</code> (í‰ê·  ì—°ë ¹)ì—ì„œì˜ <strong>ê¸°ëŒ€ log-ìƒì¡´ì‹œê°„</strong> = 0.25</td>
</tr>
<tr class="even">
<td>â†’ (= e^{0.25})ë…„</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td><strong>age_c</strong></td>
<td>0.02</td>
<td>[â€“0.02, 0.06]</td>
<td>ì—°ë ¹ì´ í‰ê· ë³´ë‹¤ 1ë…„ ë†’ì•„ì§ˆ ë•Œ ê¸°ëŒ€ log-ìƒì¡´ì‹œê°„ì´ +0.02 ì¦ê°€</td>
</tr>
<tr class="even">
<td>â†’ ìƒì¡´ì‹œê°„ ì•½ 2% ì¦ê°€, í•´ì €ë“œ ì•½ 2% ê°ì†Œ ((=e^{-0.02}))</td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<ul>
<li><strong>Credible Interval</strong>ì´ 0ì„ í¬í•¨í•˜ë¯€ë¡œ, <code>age_c</code> íš¨ê³¼ëŠ” <strong>í†µê³„ì ìœ¼ë¡œ ìœ ì˜í•˜ì§€ ì•ŠìŒ</strong><br>
</li>
<li><strong>Rhat â‰ˆ 1.00</strong>, <strong>Bulk_ESS/Tail_ESS â‰« 200</strong>: MCMC ìˆ˜ë ´ ì–‘í˜¸, ìœ íš¨í‘œë³¸ ì¶©ë¶„</li>
</ul>
</section>
<section id="ê²°ë¡ -2" class="level3">
<h3 class="anchored" data-anchor-id="ê²°ë¡ -2">ğŸŸª ê²°ë¡ </h3>
<ol type="1">
<li>í‰ê·  ì—°ë ¹ ëŒ€ë¹„ 1ë…„ ì¦ê°€ ì‹œ ìƒì¡´ì‹œê°„ì´ ì•½ 2% ëŠ˜ì–´ë‚˜ê³  í•´ì €ë“œëŠ” ì•½ 2% ì¤„ì–´ë“œëŠ” ê²½í–¥ ê´€ì°°<br>
</li>
<li>ê·¸ëŸ¬ë‚˜ 95% CrIê°€ 0ì„ í¬í•¨í•˜ì—¬ <strong>ìœ ì˜ë¯¸í•œ íš¨ê³¼</strong>ë¼ ë‹¨ì •í•  ìˆ˜ ì—†ìŒ<br>
</li>
<li>ë¶„ì„ í¸ì˜ë¥¼ ìœ„í•´ <strong>age_c</strong>ë¥¼ ì‚¬ìš©í–ˆìœ¼ë¯€ë¡œ, InterceptëŠ” â€œí‰ê·  ì—°ë ¹ì—ì„œì˜ ê¸°ëŒ€ìƒì¡´ì‹œê°„â€ì„ ë‚˜íƒ€ëƒ„</li>
</ol>
</section>
</section>
<section id="bayesian-mixture-cure-model-stan" class="level2">
<h2 class="anchored" data-anchor-id="bayesian-mixture-cure-model-stan">ğŸŸ¨ 5. Bayesian Mixture Cure Model (Stan)</h2>
<section id="ëª¨í˜•-ì í•©" class="level3">
<h3 class="anchored" data-anchor-id="ëª¨í˜•-ì í•©">ğŸŸª ëª¨í˜• ì í•©</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstan)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: StanHeaders</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
rstan version 2.32.7 (Stan version 2.32.2)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>For execution on a local, multicore CPU with excess RAM we recommend calling
options(mc.cores = parallel::detectCores()).
To avoid recompilation of unchanged Stan programs, we recommend calling
rstan_options(auto_write = TRUE)
For within-chain threading using `reduce_sum()` or `map_rect()` Stan functions,
change `threads_per_chain` option:
rstan_options(threads_per_chain = 1)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'rstan'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:coda':

    traceplot</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(loo)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bayesplot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>This is bayesplot version 1.12.0</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>- Online documentation and vignettes at mc-stan.org/bayesplot</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>- bayesplot theme set to bayesplot::theme_default()</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>   * Does _not_ affect other ggplot2 plots</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>   * See ?bayesplot_theme_set for details on theme setting</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'bayesplot'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:brms':

    rhat</code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Stan ì½”ë“œ ì •ì˜</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>stan_code <span class="ot">&lt;-</span> <span class="st">"</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="st">data {</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a><span class="st">  int&lt;lower=1&gt; N;</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a><span class="st">  vector[N] age;             </span></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a><span class="st">  vector&lt;lower=0&gt;[N] time;   </span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a><span class="st">  int&lt;lower=0,upper=1&gt; status[N];</span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a><span class="st">parameters {</span></span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a><span class="st">  real beta0;</span></span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a><span class="st">  real beta_age;</span></span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a><span class="st">  real&lt;lower=0&gt; k;</span></span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a><span class="st">  real alpha0;</span></span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a><span class="st">  real alpha_age;</span></span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a><span class="st">transformed parameters {</span></span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a><span class="st">  vector[N] log_lambda = beta0 + beta_age * age;</span></span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a><span class="st">  vector[N] pi        = inv_logit(alpha0 + alpha_age * age);</span></span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a><span class="st">model {</span></span>
<span id="cb53-23"><a href="#cb53-23" aria-hidden="true" tabindex="-1"></a><span class="st">  beta0     ~ normal(-8, 2);</span></span>
<span id="cb53-24"><a href="#cb53-24" aria-hidden="true" tabindex="-1"></a><span class="st">  beta_age  ~ normal(0.07, 0.03);</span></span>
<span id="cb53-25"><a href="#cb53-25" aria-hidden="true" tabindex="-1"></a><span class="st">  k         ~ gamma(1, 1);</span></span>
<span id="cb53-26"><a href="#cb53-26" aria-hidden="true" tabindex="-1"></a><span class="st">  alpha0    ~ normal(0.4, 1);</span></span>
<span id="cb53-27"><a href="#cb53-27" aria-hidden="true" tabindex="-1"></a><span class="st">  alpha_age ~ normal(0.1, 0.05);</span></span>
<span id="cb53-28"><a href="#cb53-28" aria-hidden="true" tabindex="-1"></a><span class="st">  for (i in 1:N) {</span></span>
<span id="cb53-29"><a href="#cb53-29" aria-hidden="true" tabindex="-1"></a><span class="st">    if (status[i] == 1) {</span></span>
<span id="cb53-30"><a href="#cb53-30" aria-hidden="true" tabindex="-1"></a><span class="st">      target += log1m(pi[i])</span></span>
<span id="cb53-31"><a href="#cb53-31" aria-hidden="true" tabindex="-1"></a><span class="st">                + weibull_lpdf(time[i] | k, exp(log_lambda[i]));</span></span>
<span id="cb53-32"><a href="#cb53-32" aria-hidden="true" tabindex="-1"></a><span class="st">    } else {</span></span>
<span id="cb53-33"><a href="#cb53-33" aria-hidden="true" tabindex="-1"></a><span class="st">      real Su = exp(- pow(time[i], k) * exp(log_lambda[i]));</span></span>
<span id="cb53-34"><a href="#cb53-34" aria-hidden="true" tabindex="-1"></a><span class="st">      target += log(pi[i] + (1 - pi[i]) * Su);</span></span>
<span id="cb53-35"><a href="#cb53-35" aria-hidden="true" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb53-36"><a href="#cb53-36" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb53-37"><a href="#cb53-37" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb53-38"><a href="#cb53-38" aria-hidden="true" tabindex="-1"></a><span class="st">generated quantities {</span></span>
<span id="cb53-39"><a href="#cb53-39" aria-hidden="true" tabindex="-1"></a><span class="st">  vector[N] log_lik;</span></span>
<span id="cb53-40"><a href="#cb53-40" aria-hidden="true" tabindex="-1"></a><span class="st">  for (i in 1:N) {</span></span>
<span id="cb53-41"><a href="#cb53-41" aria-hidden="true" tabindex="-1"></a><span class="st">    if (status[i] == 1) {</span></span>
<span id="cb53-42"><a href="#cb53-42" aria-hidden="true" tabindex="-1"></a><span class="st">      log_lik[i] = log1m(pi[i])</span></span>
<span id="cb53-43"><a href="#cb53-43" aria-hidden="true" tabindex="-1"></a><span class="st">                   + weibull_lpdf(time[i] | k, exp(log_lambda[i]));</span></span>
<span id="cb53-44"><a href="#cb53-44" aria-hidden="true" tabindex="-1"></a><span class="st">    } else {</span></span>
<span id="cb53-45"><a href="#cb53-45" aria-hidden="true" tabindex="-1"></a><span class="st">      real Su = exp(- pow(time[i], k) * exp(log_lambda[i]));</span></span>
<span id="cb53-46"><a href="#cb53-46" aria-hidden="true" tabindex="-1"></a><span class="st">      log_lik[i] = log(pi[i] + (1 - pi[i]) * Su);</span></span>
<span id="cb53-47"><a href="#cb53-47" aria-hidden="true" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb53-48"><a href="#cb53-48" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb53-49"><a href="#cb53-49" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb53-50"><a href="#cb53-50" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb53-51"><a href="#cb53-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-52"><a href="#cb53-52" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. ë°ì´í„° ë¦¬ìŠ¤íŠ¸ ìƒì„±</span></span>
<span id="cb53-53"><a href="#cb53-53" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>age_c <span class="ot">&lt;-</span> df<span class="sc">$</span>age <span class="sc">-</span> <span class="fu">mean</span>(df<span class="sc">$</span>age)</span>
<span id="cb53-54"><a href="#cb53-54" aria-hidden="true" tabindex="-1"></a>stan_data <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb53-55"><a href="#cb53-55" aria-hidden="true" tabindex="-1"></a>  <span class="at">N      =</span> <span class="fu">nrow</span>(df),</span>
<span id="cb53-56"><a href="#cb53-56" aria-hidden="true" tabindex="-1"></a>  <span class="at">age    =</span> df<span class="sc">$</span>age_c,</span>
<span id="cb53-57"><a href="#cb53-57" aria-hidden="true" tabindex="-1"></a>  <span class="at">time   =</span> df<span class="sc">$</span>time_to_event <span class="sc">/</span> <span class="dv">365</span>,</span>
<span id="cb53-58"><a href="#cb53-58" aria-hidden="true" tabindex="-1"></a>  <span class="at">status =</span> <span class="fu">as.integer</span>(df<span class="sc">$</span>transition)</span>
<span id="cb53-59"><a href="#cb53-59" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb53-60"><a href="#cb53-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-61"><a href="#cb53-61" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Stan ëª¨ë¸ ë¹Œë“œ &amp; ìƒ˜í”Œë§</span></span>
<span id="cb53-62"><a href="#cb53-62" aria-hidden="true" tabindex="-1"></a><span class="co"># fit_cure_inline &lt;- stan(</span></span>
<span id="cb53-63"><a href="#cb53-63" aria-hidden="true" tabindex="-1"></a><span class="co">#   model_code = stan_code,</span></span>
<span id="cb53-64"><a href="#cb53-64" aria-hidden="true" tabindex="-1"></a><span class="co">#   data       = stan_data,</span></span>
<span id="cb53-65"><a href="#cb53-65" aria-hidden="true" tabindex="-1"></a><span class="co">#   iter       = 4000,</span></span>
<span id="cb53-66"><a href="#cb53-66" aria-hidden="true" tabindex="-1"></a><span class="co">#   warmup     = 1000,</span></span>
<span id="cb53-67"><a href="#cb53-67" aria-hidden="true" tabindex="-1"></a><span class="co">#   chains     = 4,</span></span>
<span id="cb53-68"><a href="#cb53-68" aria-hidden="true" tabindex="-1"></a><span class="co">#   cores      = 4,</span></span>
<span id="cb53-69"><a href="#cb53-69" aria-hidden="true" tabindex="-1"></a><span class="co">#   seed       = 123</span></span>
<span id="cb53-70"><a href="#cb53-70" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb53-71"><a href="#cb53-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-72"><a href="#cb53-72" aria-hidden="true" tabindex="-1"></a><span class="co"># save(fit_cure_inline, file = file.path(path_save, "fit_cure_inline.RData"))</span></span>
<span id="cb53-73"><a href="#cb53-73" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="fu">file.path</span>(path_save, <span class="st">"fit_cure_inline.RData"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="íŒŒë¼ë¯¸í„°-ìš”ì•½-í•´ì„" class="level3">
<h3 class="anchored" data-anchor-id="íŒŒë¼ë¯¸í„°-ìš”ì•½-í•´ì„">ğŸŸª íŒŒë¼ë¯¸í„° ìš”ì•½ í•´ì„</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. íŒŒë¼ë¯¸í„° ìš”ì•½</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit_cure_inline,</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">pars  =</span> <span class="fu">c</span>(<span class="st">"beta0"</span>,<span class="st">"beta_age"</span>,<span class="st">"k"</span>,<span class="st">"alpha0"</span>,<span class="st">"alpha_age"</span>),</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.025</span>,<span class="fl">0.5</span>,<span class="fl">0.975</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Inference for Stan model: anon_model.
4 chains, each with iter=4000; warmup=1000; thin=1; 
post-warmup draws per chain=3000, total post-warmup draws=12000.

           mean se_mean   sd  2.5%   50% 97.5% n_eff Rhat
beta0     -2.39    0.01 0.65 -3.91 -2.30 -1.38  5170    1
beta_age   0.07    0.00 0.03  0.02  0.07  0.12 11312    1
k          0.46    0.00 0.13  0.23  0.45  0.76  6186    1
alpha0    -1.49    0.01 0.67 -2.84 -1.47 -0.22  8782    1
alpha_age  0.08    0.00 0.05 -0.01  0.08  0.17  9664    1

Samples were drawn using NUTS(diag_e) at Sat May 17 03:18:52 2025.
For each parameter, n_eff is a crude measure of effective sample size,
and Rhat is the potential scale reduction factor on split chains (at 
convergence, Rhat=1).</code></pre>
</div>
</div>
<table class="caption-top table">
<colgroup>
<col style="width: 23%">
<col style="width: 21%">
<col style="width: 32%">
<col style="width: 21%">
</colgroup>
<thead>
<tr class="header">
<th>íŒŒë¼ë¯¸í„°</th>
<th>í‰ê·  (mean)</th>
<th>95% CrI</th>
<th>í•´ì„</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>beta0</strong></td>
<td>â€“2.39</td>
<td>[â€“3.91, â€“1.38]</td>
<td><code>age_c = 0</code> (í‰ê·  ì—°ë ¹)ì—ì„œ <strong>uncured ê·¸ë£¹ì˜ ë¡œê·¸ ìœ„í—˜ë¥ </strong>.</td>
</tr>
<tr class="even">
<td>â†’ (_0 = e^{-2.39} )ìœ¼ë¡œ ë‚®ì€ ì´ˆê¸° ìœ„í—˜ë¥ </td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td><strong>beta_age</strong></td>
<td>+0.07</td>
<td>[0.02, 0.12]</td>
<td>ì—°ë ¹ì´ 1ë…„ ì¦ê°€í•˜ë©´ <strong>uncured ê·¸ë£¹ì—ì„œ ì‚¬ê±´ ë°œìƒ ìœ„í—˜ë¥ </strong>ì´ ì•½ 7% ì¦ê°€</td>
</tr>
<tr class="even">
<td>â†’ $ e^{0.07} $, <strong>í†µê³„ì ìœ¼ë¡œ ìœ ì˜í•¨</strong></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td><strong>k</strong></td>
<td>0.46</td>
<td>[0.23, 0.76]</td>
<td><strong>Weibull shape parameter</strong></td>
</tr>
<tr class="even">
<td>â†’ (k &lt; 1) â†’ ì‹œê°„ì´ ì§€ë‚ ìˆ˜ë¡ ì‚¬ê±´ ìœ„í—˜ì´ ê°ì†Œí•˜ëŠ” í˜•íƒœ</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td><strong>alpha0</strong></td>
<td>â€“1.49</td>
<td>[â€“2.84, â€“0.22]</td>
<td>í‰ê·  ì—°ë ¹ì—ì„œ <strong>ì™„ì¹˜(logit) intercept</strong></td>
</tr>
<tr class="even">
<td>â†’ (_0 = ^{-1}(-1.49) %) ì™„ì¹˜ìœ¨ ì¶”ì •</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td><strong>alpha_age</strong></td>
<td>+0.08</td>
<td>[â€“0.01, 0.17]</td>
<td>ë‚˜ì´ê°€ ë§ì„ìˆ˜ë¡ ì™„ì¹˜ë  í™•ë¥ ì´ ì¦ê°€í•˜ëŠ” ê²½í–¥</td>
</tr>
<tr class="even">
<td>â†’ í•˜ì§€ë§Œ 95% CrIì— 0ì´ í¬í•¨ë˜ì–´ <strong>ê²½ê³„ì ìœ¼ë¡œ ìœ ì˜í•¨</strong></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<hr>
<section id="ìš”ì•½-í•´ì„" class="level4">
<h4 class="anchored" data-anchor-id="ìš”ì•½-í•´ì„">ìš”ì•½ í•´ì„</h4>
<ul>
<li><strong>Uncured ê·¸ë£¹ì˜ ìœ„í—˜ë¥ </strong>ì€ í‰ê·  ì—°ë ¹ì—ì„œ ë‚®ìœ¼ë©°($\lambda_0 \approx 0.09$),<br>
<strong>ì‹œê°„ì´ ì§€ë‚ ìˆ˜ë¡ ê°ì†Œ</strong>í•˜ëŠ” í˜•íƒœ ((k &lt; 1))ë¥¼ ë”°ë¦„.</li>
<li><strong>ì—°ë ¹ì´ ë†’ì„ìˆ˜ë¡ ì‚¬ê±´ ë°œìƒ ìœ„í—˜ì´ ìœ ì˜ë¯¸í•˜ê²Œ ì¦ê°€</strong>í•˜ë©° (ì•½ +7%/ë…„),<br>
<strong>ì™„ì¹˜ í™•ë¥ ë„ ì¦ê°€í•˜ëŠ” ê²½í–¥</strong>ì„ ë³´ì´ì§€ë§Œ ê·¸ íš¨ê³¼ëŠ” í†µê³„ì ìœ¼ë¡œ ìœ ì˜í•˜ì§€ ì•ŠìŒ.</li>
<li><strong>í‰ê·  ì—°ë ¹ í™˜ìì˜ ì™„ì¹˜ ë¹„ìœ¨ì€ ì•½ 18%ë¡œ ì¶”ì •</strong>ë˜ì–´, ì¼ë¶€ ì˜êµ¬ì  ê´€í•´(cure) ì§‘ë‹¨ì´ ì¡´ì¬í•¨.</li>
</ul>
<hr>
</section>
<section id="ìˆ˜ë ´-ì§„ë‹¨-ê²°ê³¼" class="level4">
<h4 class="anchored" data-anchor-id="ìˆ˜ë ´-ì§„ë‹¨-ê²°ê³¼">ìˆ˜ë ´ ì§„ë‹¨ ê²°ê³¼</h4>
<ul>
<li><strong>Rhat = 1.00</strong>, <strong>n_eff â‰« 1000</strong> â†’ MCMC ì²´ì¸ ìˆ˜ë ´ ìš°ìˆ˜, posterior ì¶”ì • ì‹ ë¢°ë„ ë†’ìŒ</li>
</ul>
</section>
</section>
<section id="ì‚¬í›„ë¶„í¬-ì‹œê°í™”" class="level3">
<h3 class="anchored" data-anchor-id="ì‚¬í›„ë¶„í¬-ì‹œê°í™”">ğŸŸª ì‚¬í›„ë¶„í¬ ì‹œê°í™”</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. Posterior ë¶„í¬ ì‹œê°í™”</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>post_array <span class="ot">&lt;-</span> <span class="fu">as.array</span>(fit_cure_inline)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_areas</span>(</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  post_array,</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">pars =</span> <span class="fu">c</span>(<span class="st">"beta0"</span>,<span class="st">"beta_age"</span>,<span class="st">"alpha0"</span>,<span class="st">"alpha_age"</span>,<span class="st">"k"</span>),</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">prob =</span> <span class="fl">0.95</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> <span class="fu">labs</span>(</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">"Mixture Cure Model Posterior Distributions"</span>,</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">x     =</span> <span class="st">"Value"</span>,</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">y     =</span> <span class="st">"Parameter"</span></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Survival-Analysis_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<table class="caption-top table">
<colgroup>
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 54%">
</colgroup>
<thead>
<tr class="header">
<th>íŒŒë¼ë¯¸í„°</th>
<th>ì¤‘ì•™ê°’ (50%ile)</th>
<th>95% CrI</th>
<th>í˜•íƒœ &amp; í•´ì„</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>beta0</strong></td>
<td>â€“2.30</td>
<td>[â€“3.91, â€“1.38]</td>
<td>ë¹„êµì  ì¢ì€ ë¶„í¬<br>í‰ê· ì—°ë ¹ì—ì„œ uncured ê·¸ë£¹ì˜ log ìœ„í—˜ë¥  intercept</td>
</tr>
<tr class="even">
<td><strong>beta_age</strong></td>
<td>+0.07</td>
<td>[0.02, +0.12]</td>
<td>ì•„ì£¼ ì¢ì€ ë¶„í¬ (ì •ë°€ë„ ë†’ìŒ)<br>ì—°ë ¹ 1ë…„â†‘ ì‹œ uncured ìœ„í—˜ë¥  ì•½ 7%â†‘ (ëª¨ë‘ ì–‘ìˆ˜â†’í†µê³„ì  ìœ ì˜)</td>
</tr>
<tr class="odd">
<td><strong>alpha0</strong></td>
<td>â€“1.47</td>
<td>[â€“2.84, â€“0.22]</td>
<td>ì¤‘ê°„ í­ ë¶„í¬<br>í‰ê· ì—°ë ¹ì—ì„œ ì™„ì¹˜ í™•ë¥  intercept ((_0%))</td>
</tr>
<tr class="even">
<td><strong>alpha_age</strong></td>
<td>+0.08</td>
<td>[â€“0.01, +0.17]</td>
<td>ì¤‘ê°„ í­ ë¶„í¬<br>ì—°ë ¹ 1ë…„â†‘ ì‹œ ì™„ì¹˜ í™•ë¥  ì¦ê°€ ê²½í–¥, 95% CrI ì¼ë¶€ ìŒìˆ˜ í¬í•¨(ê²½ê³„ì  ìœ ì˜ì„±)</td>
</tr>
<tr class="odd">
<td><strong>k</strong></td>
<td>+0.45</td>
<td>[0.23, +0.76]</td>
<td>ìƒëŒ€ì ìœ¼ë¡œ ë„“ì€ ë¶„í¬<br>Weibull shape (k&lt;1)â†’ì‹œê°„ ê²½ê³¼ ì‹œ uncured ê·¸ë£¹ì˜ hazard ê°ì†Œí•¨ì„ ì‹œì‚¬</td>
</tr>
</tbody>
</table>
<ul>
<li><strong>ë¶„í¬ í­ (CrI ê¸¸ì´)</strong>:
<ul>
<li><code>beta_age</code>ê°€ ê°€ì¥ ì¢ì•„ posterior ë¶ˆí™•ì‹¤ì„± ì ìŒ<br>
</li>
<li><code>alpha_age</code>, <code>k</code>ëŠ” ìƒëŒ€ì ìœ¼ë¡œ í­ì´ ë„“ì–´ ë¶ˆí™•ì‹¤ì„± ë‹¤ì†Œ í¼<br>
</li>
</ul></li>
<li><strong>ì¤‘ì•™ê°’ ìœ„ì¹˜</strong>:
<ul>
<li><code>beta_age</code>, <code>alpha_age</code> ëª¨ë‘ ì–‘ìˆ˜ ì¤‘ì•™ê°’ â†’ ì—°ë ¹ íš¨ê³¼ê°€ ì¼ê´€ë˜ê²Œ positive<br>
</li>
<li><code>beta0</code>, <code>alpha0</code> ëŠ” ìŒìˆ˜ ì¤‘ì•™ê°’ â†’ ë‚®ì€ baseline ìœ„í—˜ë¥ /ì™„ì¹˜í™•ë¥ </li>
</ul></li>
</ul>
<blockquote class="blockquote">
<p><strong>ê²°ë¡ </strong>: ì—°ë ¹ì´ ë†’ì„ìˆ˜ë¡ uncured ì‚¬ê±´ ìœ„í—˜ì´ ìœ ì˜í•˜ê²Œ ì¦ê°€í•˜ê³ (<code>beta_age</code>),<br>
ì™„ì¹˜ í™•ë¥ ë„ ì¦ê°€ ê²½í–¥ì„ ë³´ì´ë‚˜(<code>alpha_age</code>) ì¼ë¶€ ë¶ˆí™•ì‹¤ì„±ì´ ë‚¨ì•„ ìˆìŒ.<br>
Weibull shape (<code>k</code>) ë¶„í¬ë¥¼ í†µí•´ ì „ì²´ uncured hazardê°€ ì‹œê°„ì´ ì§€ë‚¨ì— ë”°ë¼ ê°ì†Œí•¨ì„ ì‹œê°ì ìœ¼ë¡œ í™•ì¸í•  ìˆ˜ ìˆìŒ.</p>
</blockquote>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>