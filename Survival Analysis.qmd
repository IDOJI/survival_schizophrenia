---
title: "Survival Analysis on Schizophrenia CHR"
author: "ido ji"
format: 
  html:
    toc: true
    toc-depth: 4       # #### í—¤ë”ê¹Œì§€ í‘œì‹œ
    toc-expand: true   # í•­ìƒ í¼ì³ì§„ ìƒíƒœë¡œ í‘œì‹œ
editor: visual
---

# ğŸ“¦ íŒ¨í‚¤ì§€ ì„¤ì¹˜ ë° ë¡œë”©

```{r setup, message=FALSE}
library(survival)
library(survminer)
library(cmprsk)
library(smcure)
library(rstanarm)
library(bayesSurv)
filter <- dplyr::filter
select <- dplyr::select
path_save = "/Users/Ido/Documents/GitHub/Obsidian/â˜”ï¸Papers_Writing(á„‚á…©á†«á„†á…®á†« á„Šá…³á„€á…µ)/âœ…Currently working/ãŠ™ï¸á„Œá…©á„’á…§á†«á„‡á…§á†¼ á„‰á…¢á†¼á„Œá…©á†«á„‡á…®á†«á„‰á…¥á†¨/ë°ì´í„° ë¶„ì„/attachments"
```

# ğŸ“Š ë°ì´í„° ì¤€ë¹„

```{r data-prep}
path_data <- "/Users/Ido/Documents/GitHub/Obsidian/â˜”ï¸Papers_Writing(á„‚á…©á†«á„†á…®á†« á„Šá…³á„€á…µ)/âœ…Currently working/ãŠ™ï¸á„Œá…©á„’á…§á†«á„‡á…§á†¼ á„‰á…¢á†¼á„Œá…©á†«á„‡á…®á†«á„‰á…¥á†¨/ë°ì´í„° ë¶„ì„/attachments/survival.csv"
df <- read.csv(path_data)

```

# ğŸŸ¥ 1. Kaplanâ€“Meier ìƒì¡´ë¶„ì„

## ğŸŸ¨ ì „ì²´ ê·¸ë£¹

### ğŸŸª ì¹´í”Œë€â€“ë§ˆì´ì–´ ì í•©

```{r km-overall-fit}
fit_km1 <- survfit(Surv(dur_transition, transition) ~ 1, data = df)
```

### ğŸŸª íŠ¹ì • ì‹œì (730ì¼) ìƒì¡´ìœ¨

```{r km-overall-summary}
summary(fit_km1, times = 730)
```

### ğŸŸª ì í•©ê²°ê³¼ ìš”ì•½ í•´ì„(730ì¼ ì‹œì  ê¸°ì¤€)

| í•­ëª©           | ì˜ë¯¸                                                    |
|----------------|---------------------------------------------------------|
| `time`         | í‰ê°€ ì‹œì  (730ì¼ = 2ë…„)                                 |
| `n.risk`       | í•´ë‹¹ ì‹œì ê¹Œì§€ ìƒì¡´(ì „ì´ ì•ˆ ë¨) ìƒíƒœë¡œ ê´€ì°° ì¤‘ì¸ ëŒ€ìƒ ìˆ˜ |
| `n.event`      | ì‚¬ê±´(ì „ì´) ë°œìƒ ìˆ˜                                      |
| `survival`     | ì¶”ì • ìƒì¡´ í™•ë¥  â†’ ì•½ **72.2%**                           |
| `std.err`      | ìƒì¡´ë¥ ì˜ í‘œì¤€ ì˜¤ì°¨                                      |
| `lower 95% CI` | ìƒì¡´ë¥  95% ì‹ ë¢°êµ¬ê°„ í•˜í•œ = **59.7%**                    |
| `upper 95% CI` | ìƒì¡´ë¥  95% ì‹ ë¢°êµ¬ê°„ ìƒí•œ = **87.4%**                    |

> **CHR ìƒíƒœì¸ ê°œì¸ì´ ì¡°í˜„ë³‘ìœ¼ë¡œ ì „ì´ë˜ì§€ ì•Šê³  2ë…„(730ì¼)ê°„ ìœ ì§€ë  í™•ë¥ ì€ ì•½ 72.2%ì´ë©°, 95% ì‹ ë¢°êµ¬ê°„ì€ 59.7% \~ 87.4%ì´ë‹¤.**

### ğŸŸª ì¹´í”Œë€-ë§ˆì´ì–´ ê³¡ì„  ë° ì‹ ë¢°êµ¬ê°„ ì‹œê°í™”

```{r km-overall-gg}
ggsurvplot(fit_km1,

conf.int = TRUE,

xlab = "Days",

ylab = "Transition-free Survival Probability",

title = "KM: CHR â†’ Schizophrenia (Total)")


```

#### ğŸ“Š ê·¸ë˜í”„ í•´ì„

-   **ë¶‰ì€ ì‹¤ì„ **: Kaplan-Meier ì¶”ì • ìƒì¡´ ê³¡ì„  ( \hat{S}(t) )
-   **íšŒìƒ‰ ìŒì˜**: 95% ì‹ ë¢°êµ¬ê°„
-   `+` í‘œì‹œ: ê²€ì—´ëœ ì‚¬ë¡€ (ì „ì´ ì—†ì´ ê´€ì°° ì¢…ë£Œ)
-   ê³¡ì„ ì´ í‰í‰í•´ì§€ëŠ” êµ¬ê°„ì€ ì‚¬ê±´ì´ ë” ì´ìƒ ë°œìƒí•˜ì§€ ì•Šì•˜ìŒì„ ë‚˜íƒ€ëƒ„
-   ì‹œê°ì ìœ¼ë¡œë„ 730ì¼ ì‹œì ì—ì„œ ì•½ 0.72 ìˆ˜ì¤€ì˜ ìƒì¡´ í™•ë¥ ì„ í™•ì¸ ê°€ëŠ¥

### ğŸŸª ê²°ë¡  ìš”ì•½

| í•­ëª©           | ê°’                                                  |
|----------------|-----------------------------------------------------|
| ìƒì¡´ í™•ë¥       | **72.2%**                                           |
| ì‚¬ê±´ ë°œìƒë¥     | **27.8%**                                           |
| ì‹ ë¢°êµ¬ê°„ (95%) | **\[59.7%, 87.4%\]**                                |
| í•´ì„           | CHR ìƒíƒœì˜ ì•½ 72%ëŠ” 2ë…„ ë‚´ ì¡°í˜„ë³‘ìœ¼ë¡œ ì „ì´ë˜ì§€ ì•ŠìŒ |

## ğŸŸ¨ ì„±ë³„ ê·¸ë£¹ë³„ ìƒì¡´ ë¶„ì„: Kaplanâ€“Meier ë° Log-rank ê²€ì •

### ğŸŸª Kaplanâ€“Meier ìƒì¡´ê³¡ì„ : ì„±ë³„ ê·¸ë£¹ ë¹„êµ

```{r}
fit_km2 <- survfit(Surv(dur_transition, transition) ~ sex, data = df)

ggsurvplot(
  fit_km2,
  conf.int = TRUE,
  pval = TRUE,
  xlab = "Days",
  ylab = "Transition-free Survival Probability",
  title = "KM: CHR â†’ Schizophrenia by Sex",
  legend.title = "Sex",
  legend.labs = c("Female (0)", "Male (1)")
)
```

> Kaplanâ€“Meier ìƒì¡´ê³¡ì„ ì€ ì„±ë³„(sex)ì— ë”°ë¼ **ì „ì´ ì—†ëŠ” ìƒì¡´ë¥ (Survival Probability)**ì„ ì‹œê°ì ìœ¼ë¡œ ë¹„êµ. ì‹¤ì„ ì€ ìƒì¡´ ì¶”ì • ê³¡ì„ , ìŒì˜ì€ 95% ì‹ ë¢°êµ¬ê°„ì„ ì˜ë¯¸í•˜ë©°, `+` ê¸°í˜¸ëŠ” ì¤‘ë„ê²€ì—´ëœ ê´€ì¸¡ì¹˜ë¥¼ ë‚˜íƒ€ëƒ„.

------------------------------------------------------------------------

### ğŸŸª 730ì¼(2ë…„) ì‹œì  ìƒì¡´ìœ¨ ë¹„êµ

```{r}
summary(fit_km2, times = 730)
```

| ì„±ë³„ (`sex`) | ìƒì¡´ë¥  ( $\hat{S}(730)$ ) | í‘œì¤€ì˜¤ì°¨ (SE) | 95% ì‹ ë¢°êµ¬ê°„ | n.risk | n.event |
|------------|------------|------------|------------|------------|------------|
| Female (0) | 64.3% | 0.114 | \[45.4%, 91.1%\] | 6 | 7 |
| Male (1) | 78.8% | 0.0852 | \[63.8%, 97.4%\] | 13 | 5 |

> **í•´ì„**: 2ë…„ ì‹œì ì—ì„œ ì—¬ì„±ì€ ì•½ 64.3%, ë‚¨ì„±ì€ ì•½ 78.8%ê°€ ì „ì´ ì—†ì´ ìƒì¡´. ë‚¨ì„±ì´ ë” ë†’ì€ ìƒì¡´ë¥ ì„ ë³´ì˜€ìœ¼ë‚˜, ì‹ ë¢°êµ¬ê°„ì´ ë„“ì–´ í†µê³„ì ìœ¼ë¡œ ìœ ì˜í•œ ì°¨ì´ì¸ì§€ ì¶”ê°€ ë¶„ì„ì´ í•„ìš”.

------------------------------------------------------------------------

### ğŸŸª Log-rank ê²€ì •: ì„±ë³„ ê°„ ìƒì¡´ê³¡ì„  ì°¨ì´ ê²€ì •

```{r}
fit_logrank <- survdiff(Surv(dur_transition, transition) ~ sex, data = df)
chisq <- fit_logrank$chisq
dfree <- length(fit_logrank$n) - 1
p_val <- 1 - pchisq(chisq, dfree)
fit_logrank
```

| ê·¸ë£¹       | N   | Observed | Expected | (Oâˆ’E)Â² / E | (Oâˆ’E)Â² / V |
|------------|-----|----------|----------|------------|------------|
| Female (0) | 26  | 7        | 5.1      | 0.707      | 1.24       |
| Male (1)   | 28  | 5        | 6.9      | 0.523      | 1.24       |

-   **ì¹´ì´ì œê³± í†µê³„ëŸ‰**: 1.2\
-   **ììœ ë„**: 1\
-   **p-value**: 0.265

> **ê²°ë¡ **: ì„±ë³„ì— ë”°ë¥¸ ìƒì¡´ê³¡ì„  ì°¨ì´ëŠ” **í†µê³„ì ìœ¼ë¡œ ìœ ì˜í•˜ì§€ ì•ŠìŒ** (p = 0.265 \> 0.05). ë”°ë¼ì„œ CHR í™˜ìì˜ ì¡°í˜„ë³‘ ì „ì´ ìƒì¡´ì‹œê°„ì€ ì„±ë³„ ê°„ ìœ ì˜ë¯¸í•œ ì°¨ì´ë¥¼ ë³´ì´ì§€ ì•ŠìŒ.

------------------------------------------------------------------------

### ğŸŸª ì¢…í•© ìš”ì•½

| í•­ëª©          | ê²°ê³¼                         |
|---------------|------------------------------|
| ë¶„ì„ ê¸°ë²•     | Kaplan-Meier + Log-rank ê²€ì • |
| ë¹„êµ ë³€ìˆ˜     | ì„±ë³„ (`sex`)                 |
| ìƒì¡´ë¥  ì°¨ì´   | ì—¬ì„± 64.3% vs ë‚¨ì„± 78.8%     |
| í†µê³„ì  ìœ ì˜ì„± | p = 0.265 (ìœ ì˜í•˜ì§€ ì•ŠìŒ)    |

> *Kaplanâ€“Meier ìƒì¡´ê³¡ì„  ë° log-rank ê²€ì • ê²°ê³¼, ì„±ë³„ì— ë”°ë¥¸ CHR í™˜ìì˜ ì¡°í˜„ë³‘ ì „ì´ ìƒì¡´ë¥ ì€ ì‹œê°ì ìœ¼ë¡œ ì°¨ì´ë¥¼ ë³´ì˜€ìœ¼ë‚˜, í†µê³„ì ìœ¼ë¡œëŠ” ìœ ì˜í•˜ì§€ ì•Šì•˜ë‹¤ (Ï‡Â² = 1.2, df = 1, p = 0.265).*

# ğŸŸ¥ 2. Mixture Cure Model (PH)

```{r cure-ph}
# fit_cure_ph <- smcure(Surv(dur_transition, transition) ~ age, 
#                       cureform = ~ age,
#                       model = "ph", data = df)

# save(fit_cure_ph, file = file.path(path_save, "fit_cure_ph.RData"))
load(file.path(path_save, "fit_cure_ph.RData"))

printsmcure(fit_cure_ph)

```

### ğŸŸ¨ ë¶„ì„ ê°œìš”

`smcure()` í•¨ìˆ˜ë¥¼ í†µí•´ **PH ê¸°ë°˜ Mixture Cure Model**ì„ ì í•©.

í•´ë‹¹ ëª¨ë¸ì€ **ì¼ë¶€ í”¼í—˜ìê°€ ì‚¬ê±´(event)ì„ ì˜ì›íˆ ê²ªì§€ ì•Šì„ ìˆ˜ ìˆìŒ**ì„ ë°˜ì˜í•˜ì—¬ ëª¨ì§‘ë‹¨ì„ ë‹¤ìŒ ë‘ ê·¸ë£¹ìœ¼ë¡œ ë¶„ë¦¬:

-   **Cured (ì™„ì¹˜ì)**: ì‚¬ê±´ ë°œìƒ ê°€ëŠ¥ì„± ì—†ìŒ
-   **Uncured (ë¯¸ì™„ì¹˜ì)**: ì‚¬ê±´ ë°œìƒ ê°€ëŠ¥

------------------------------------------------------------------------

### ğŸŸ¨ ìˆ˜í•™ì  ëª¨ë¸ êµ¬ì¡°

ì „ì²´ ìƒì¡´í•¨ìˆ˜ì˜ êµ¬ì„±:

\\\[ S(t \mid Z_i, X_i) = \pi(Z_i) + (1 - \pi(Z_i)) S_u(t \mid X_i) \\\]

-   \\(\pi(Z_i)\\) : ì¹˜ìœ  í™•ë¥  (ë¡œì§€ìŠ¤í‹± íšŒê·€)
-   \\(S_u(t \mid X_i)\\): ì¹˜ìœ ë˜ì§€ ì•Šì€ ê·¸ë£¹ì˜ ìƒì¡´í•¨ìˆ˜ (Cox PH ê¸°ë°˜)

------------------------------------------------------------------------

### ğŸŸ¨ ëª¨ë¸ ì¶”ì • ê²°ê³¼

#### ğŸ”¹ Cure Probability Model (ì™„ì¹˜ í™•ë¥  ëª¨í˜•)

| ê³„ìˆ˜      | ì¶”ì •ê°’  | í‘œì¤€ì˜¤ì°¨ | z ê°’   | p ê°’   |
|-----------|---------|----------|--------|--------|
| Intercept | â€“3.1285 | 1.9090   | â€“1.639 | 0.1012 |
| age       | 0.0929  | 0.0814   | 1.140  | 0.2541 |

> ë‚˜ì´ê°€ ë§ì„ìˆ˜ë¡ ì™„ì¹˜ í™•ë¥ ì´ ì¦ê°€í•˜ëŠ” ê²½í–¥ì„ ë³´ì´ë‚˜ **p-ê°’ì´ ìœ ì˜ìˆ˜ì¤€ 0.05ë¥¼ ì´ˆê³¼**í•˜ì—¬ í†µê³„ì ìœ¼ë¡œ ìœ ì˜í•˜ì§€ ì•ŠìŒ

#### ğŸ”¹ Failure Time Model (PH ëª¨í˜•)

| ê³„ìˆ˜ | ì¶”ì •ê°’  | í‘œì¤€ì˜¤ì°¨ | z ê°’   | p ê°’   |
|------|---------|----------|--------|--------|
| age  | â€“0.1238 | 1.4886   | â€“0.083 | 0.9337 |

> ë‚˜ì´ê°€ ë§ì„ìˆ˜ë¡ ì‚¬ê±´ ë°œìƒ ìœ„í—˜ì´ ê°ì†Œí•˜ëŠ” ê²½í–¥ì´ë‚˜, **p-ê°’ì´ ë§¤ìš° í¬ë©° ìœ ì˜í•˜ì§€ ì•ŠìŒ**

------------------------------------------------------------------------

### ğŸŸ¨ í•´ì„ ìš”ì•½

-   **ì™„ì¹˜ í™•ë¥ **: ë‚˜ì´ì˜ ê³„ìˆ˜ëŠ” ì–‘ìˆ˜ â†’ ë‚˜ì´ê°€ ë§ì„ìˆ˜ë¡ ì™„ì¹˜ë  ê°€ëŠ¥ì„±ì´ ë†’ì•„ì§€ëŠ” ê²½í–¥. ê·¸ëŸ¬ë‚˜ í†µê³„ì ìœ¼ë¡œ ìœ ì˜í•˜ì§€ ì•ŠìŒ
-   **ì‚¬ê±´ ë°œìƒ ì‹œê°„**: ë‚˜ì´ì˜ ê³„ìˆ˜ëŠ” ìŒìˆ˜ â†’ ë‚˜ì´ê°€ ë§ì„ìˆ˜ë¡ ì „ì´ê°€ ëŠë ¤ì§ˆ ê°€ëŠ¥ì„±. ë§ˆì°¬ê°€ì§€ë¡œ ìœ ì˜í•˜ì§€ ì•ŠìŒ
-   **ì „ë°˜ì  ê²°ë¡ **: ë³¸ ë°ì´í„°ì—ì„œëŠ” ë‚˜ì´ê°€ ì™„ì¹˜ ì—¬ë¶€ë‚˜ ì‚¬ê±´ ë°œìƒ ì‹œê°„ì— **ìœ ì˜í•œ ì˜í–¥ì„ ì£¼ì§€ ì•ŠìŒ**

------------------------------------------------------------------------

### ğŸŸ¨ ê²°ë¡ 

| êµ¬ì„± ìš”ì†Œ | ë‚˜ì´(age)ì˜ íš¨ê³¼ | ìœ ì˜ì„± (p-value) | í•´ì„ ìš”ì•½ |
|-----------------|------------------|-----------------|--------------------|
| ì™„ì¹˜ í™•ë¥  | ì¦ê°€ì‹œí‚¤ëŠ” ê²½í–¥ (ì–‘ì˜ ê³„ìˆ˜) | 0.2541 | ìœ ì˜í•˜ì§€ ì•ŠìŒ |
| ìƒì¡´ì‹œê°„ (ì „ì´ ì‹œê°„) | ê°ì†Œì‹œí‚¤ëŠ” ê²½í–¥ (ìŒì˜ ê³„ìˆ˜) | 0.9337 | ìœ ì˜í•˜ì§€ ì•ŠìŒ |

> í˜„ì¬ ëª¨ë¸ì—ì„œëŠ” **ë‚˜ì´ê°€ ì¤‘ìš”í•œ ì„¤ëª…ë³€ìˆ˜ê°€ ì•„ë‹˜**ì„ ì‹œì‚¬. ë‹¤ë¥¸ ê³µë³€ëŸ‰ ì¶”ê°€, í˜¹ì€ ëª¨ë¸ ì¬ì„¤ê³„ í•„ìš”

------------------------------------------------------------------------

# ğŸŸ¥ 3. Competing Risks (transition vs remission)

## ğŸŸ¨ ì´ë²¤íŠ¸ íƒ€ì… ë° ì‹œê°„ ì „ì²˜ë¦¬

```{r cr-prep}
df$event_type <- ifelse(df$transition == 1, 1, ifelse(df$remission == 1, 2, 0))

df$time_to_event <- pmin(df$dur_transition, df$dur_remission, na.rm = TRUE)


```

## ğŸŸ¨ ì „ì²´ ì½”í˜¸íŠ¸ ëˆ„ì  ë°œìƒ í•¨ìˆ˜(CIF) ì¶”ì • ê²°ê³¼ í•´ì„

```{r cif-estimate}
fit_cr <- cuminc(ftime = df$time_to_event, fstatus = df$event_type)

# ê²°ê³¼ ì¶œë ¥
print(fit_cr)

```

### ğŸŸª ì¶”ì •ì¹˜ ë° ë¶„ì‚° (`print(fit_cr)` ê²°ê³¼)

| ì‹œê°„ (ì¼) | CIF(Transition) | ë¶„ì‚° (var) | CIF(Remission) | ë¶„ì‚° (var) |
|-----------|-----------------|------------|----------------|------------|
| **200**   | 0.1402          | 0.002518   | 0.0000         | 0.000000   |
| **400**   | 0.1673          | 0.003099   | 0.0737         | 0.001724   |
| **600**   | 0.2793          | 0.005160   | 0.2307         | 0.005632   |

> â€“ **CIF(Transition)**: ì¡°í˜„ë³‘ ì „ì´ ì‚¬ê±´ì˜ ëˆ„ì  ë°œìƒ í™•ë¥ \
> â€“ **CIF(Remission)**: ê´€í•´ ì‚¬ê±´ì˜ ëˆ„ì  ë°œìƒ í™•ë¥ \
> â€“ **ë¶„ì‚°(var)**: ê° ì¶”ì •ì¹˜ì˜ ë¶ˆí™•ì‹¤ì„±(variance)

### ğŸŸª ê·¸ë˜í”„ í•´ì„

```{r}

plot(fit_cr,

xlab = "Days",

ylab = "Cumulative Incidence",

col = c("blue", "red"),

lwd = 2,

lty = 1:2)

legend("bottomright",

legend = c("Transition", "Remission"),

col = c("blue", "red"),

lty = 1:2,

bty = "n")
```

-   **íŒŒë€ ì‹¤ì„ **: ì „ì´(Transition)ì˜ CIF\
-   **ë¹¨ê°„ ì ì„ **: ê´€í•´(Remission)ì˜ CIF\
-   ì‹œê°„ ê²½ê³¼ì— ë”°ë¼ ë‘ ê³¡ì„  ëª¨ë‘ ìƒìŠ¹\
-   600ì¼ ì‹œì  ì „ì´ ì•½ **28%**, ê´€í•´ ì•½ **23%**

### ğŸŸª ì¢…í•© í•´ì„

1.  **ì´ˆê¸°(â‰¤200ì¼)**\
    â€“ ì „ì´ ì‚¬ê±´ì´ ë¨¼ì € ë°œìƒí•´ CIF(Transition) â‰ˆ **14%**, ê´€í•´ëŠ” ê±°ì˜ 0%

2.  **ì¤‘ê¸°(200â€“400ì¼)**\
    â€“ ì „ì´ ì•½ **17%** â†’ ê´€í•´ ì•½ **7%**

3.  **í›„ê¸°(400â€“600ì¼)**\
    â€“ ì „ì´ ì•½ **28%**, ê´€í•´ ì•½ **23%**

4.  **ë¹„êµ**\
    â€“ ì „ì´ ìœ„í—˜ì´ ê´€í•´ ìœ„í—˜ë³´ë‹¤ ë‹¤ì†Œ ë†’ê²Œ ë‚˜íƒ€ë‚˜ë‚˜, í° ì°¨ì´ëŠ” ì•„ë‹˜

> **ì„ìƒì  ì‹œì‚¬ì **:\
> â€“ CHR í™˜ìì—ì„œ ì¡°í˜„ë³‘ ì „ì´ì™€ ê´€í•´ê°€ ëª¨ë‘ ì‹œê°„ì´ ì§€ë‚¨ì— ë”°ë¼ ì˜ë¯¸ ìˆê²Œ ë°œìƒ\
> â€“ 2ë…„(â‰ˆ730ì¼)ê¹Œì§€ ì „ì´ ìœ„í—˜(â‰ˆ28%)ì´ ê´€í•´ ìœ„í—˜(â‰ˆ23%)ë³´ë‹¤ ì•½ê°„ ë†’ìŒ

## ğŸŸ¨ ê·¸ë£¹ë³„ Grayâ€™s test : ì„±ë³„ì— ë”°ë¥¸ CIF ì°¨ì´ ê²€ì •

### ğŸŸª ê²€ì • ê²°ê³¼

```{r cif-by-group}
fit_group <- cuminc(ftime = df$time_to_event,

fstatus = df$event_type,

group = df$sex)

print(fit_group)
```

| ì‚¬ê±´ íƒ€ì…    | stat   | p-value | df  |
|--------------|--------|---------|-----|
| **1 (ì „í™˜)** | 1.2464 | 0.2642  | 1   |
| **2 (ê´€í•´)** | 0.1343 | 0.7140  | 1   |

> **í•´ì„:** ë‘ ì‚¬ê±´ ëª¨ë‘ **p \> 0.05** ì´ë¯€ë¡œ\
> â€œë‚¨ vs ì—¬â€ ê·¸ë£¹ ê°„ ëˆ„ì ë°œìƒê³¡ì„ (CIF)ì— **í†µê³„ì ìœ¼ë¡œ ìœ ì˜í•œ ì°¨ì´ ì—†ìŒ**.

### ğŸŸª CIF ì¶”ì •ì¹˜ (\@ 200Â·400Â·600ì¼)

```{r}
print(fit_group)
```

| ê·¸ë£¹(sex) | ì‚¬ê±´ íƒ€ì… | 200ì¼  | 400ì¼  | 600ì¼  |
|-----------|-----------|--------|--------|--------|
| **0**     | ì „í™˜ (1)  | 0.2206 | 0.2206 | 0.3605 |
| **1**     | ì „í™˜ (1)  | 0.0728 | 0.1194 | 0.2126 |
| **0**     | ê´€í•´ (2)  | 0.0000 | 0.0557 | 0.3435 |
| **1**     | ê´€í•´ (2)  | 0.0000 | 0.0883 | 0.1882 |

> **í•´ì„:**\
> - ê·¸ë£¹ 0(ì˜ˆ: ë‚¨ì„±)ì€ 600ì¼ ì‹œì  ì „í™˜ â‰ˆ36.0%, ê´€í•´ â‰ˆ34.4%\
> - ê·¸ë£¹ 1(ì˜ˆ: ì—¬ì„±)ì€ 600ì¼ ì‹œì  ì „í™˜ â‰ˆ21.3%, ê´€í•´ â‰ˆ18.8%\
> ê·¸ëŸ¬ë‚˜ **Grayâ€™s testì—ì„œ ìœ ì˜í•˜ì§€ ì•Šì•˜ìœ¼ë¯€ë¡œ**\
> ì´ ì°¨ì´ëŠ” **í‘œë³¸ ì˜¤ì°¨**ë‚˜ **ìš°ì—°**ì¼ ê°€ëŠ¥ì„±ì´ ë†’ìŒ.

### ğŸŸª ê·¸ë˜í”„ í•´ì„

```{r}
plot(fit_group,

xlab = "Days",

ylab = "Cumulative Incidence")
```

-   **Solid line (0 1)**: `sex = 0 (Female)`ì˜ **Transition** ëˆ„ì ë°œìƒë¥ \
-   **Dashed line (1 1)**: `sex = 1 (Male)`ì˜ **Transition** ëˆ„ì ë°œìƒë¥ \
-   **Dotted line (0 2)**: `sex = 0 (Female)`ì˜ **Remission** ëˆ„ì ë°œìƒë¥ \
-   **Dotdash line (1 2)**: `sex = 1 (Male)`ì˜ **Remission** ëˆ„ì ë°œìƒë¥ 

> **ì£¼ìš” ê´€ì°°ì **\
> - **Female (solid)** ì „ì´ ê³¡ì„ ì´ **Male (dashed)** ì „ì´ ê³¡ì„ ë³´ë‹¤ ì „ êµ¬ê°„ì—ì„œ ë†’ì•„, ì—¬ì„± ê·¸ë£¹ì˜ ì „ì´ ìœ„í—˜ì´ ë‹¤ì†Œ ë†’ê²Œ ë‚˜íƒ€ë‚¨\
> - **Female (dotted)** ê´€í•´ ê³¡ì„ ë„ **Male (dotdash)** ê³¡ì„ ë³´ë‹¤ ë†’ì•„, ê´€í•´ ë°œìƒ ì—­ì‹œ ì—¬ì„±ì—ì„œ ë” ë¹ ë¥´ê²Œ ì¶•ì ë¨\
> - ì „ì²´ì ìœ¼ë¡œ ë‘ ê·¸ë£¹ ê°„ ì°¨ì´ëŠ” í¬ì§€ ì•Šìœ¼ë‚˜, ì—¬ì„±ì—ì„œ ì•½ê°„ ë” ë†’ì€ ëˆ„ì ë°œìƒë¥  ê²½í–¥ ê´€ì°°

> **ì„ìƒì  ì‹œì‚¬ì **\
> ì—¬ì„± ê·¸ë£¹ì—ì„œ ì¡°í˜„ë³‘ ì „ì´Â·ê´€í•´ê°€ ë‹¤ì†Œ ë¹ ë¥´ê²Œ ëˆ„ì ë˜ë‚˜, Grayâ€™s test ê²°ê³¼ í†µê³„ì ìœ¼ë¡œ ìœ ì˜í•˜ì§€ ì•Šì•˜ìœ¼ë¯€ë¡œ\
> **ì¶”ê°€ í‘œë³¸ í™•ì¥** ë˜ëŠ” **ë‹¤ë³€ëŸ‰ Fineâ€“Gray ëª¨ë¸**ì„ í†µí•´ ì°¨ì´ì˜ ìœ ì˜ì„±ì„ ì¬í™•ì¸í•  í•„ìš”ê°€ ìˆìŒ.

### ğŸŸª ê²°ë¡  ìš”ì•½

1.  **ì„±ë³„ì— ë”°ë¥¸ ì „í™˜Â·ê´€í•´ ëˆ„ì ìœ„í—˜ ì°¨ì´ ì—†ìŒ**\
    (ì „í™˜: p=0.264, ê´€í•´: p=0.714)
2.  **ì¶”ì •ì¹˜ ì°¨ì´ëŠ” í†µê³„ì  ìœ ì˜ì„± ì—†ìŒ** â†’ ì„ìƒì  ê²°ë¡ ìœ¼ë¡œëŠ” ì œí•œì 

## ğŸŸ¨ Fineâ€“Gray íšŒê·€ë¶„ì„ : ê³µë³€ëŸ‰ íš¨ê³¼ í‰ê°€

```{r fine-gray}
X <- model.matrix(~ age + sex, data = df)[, -1]
fit_fg <- crr(ftime = df$time_to_event,

fstatus = df$event_type,

cov1 = X,

failcode = 1,

cencode = 0)

summary(fit_fg)


```

### ğŸŸª ì¶”ì •ê³„ìˆ˜ ë° Subdistribution Hazard Ratio (SHR)

| ë³€ìˆ˜    | coef    | exp(coef) (SHR) | se(coef) | z      | p-value | 95% CI (SHR)     |
|-----------|-----------|-----------|-----------|-----------|-----------|-----------|
| **age** | 0.0211  | 1.021           | 0.0437   | 0.483  | 0.630   | \[0.937, 1.110\] |
| **sex** | â€“0.5886 | 0.555           | 0.6161   | â€“0.955 | 0.340   | \[0.166, 1.860\] |

> **í•´ì„**
>
> -   **age**: ë‚˜ì´ê°€ í•œ ë‹¨ìœ„ ì¦ê°€í•  ë•Œ ì „ì´(`failcode = 1`)ì˜ ëˆ„ì ìœ„í—˜ì´ ì•½ 2.1% ì¦ê°€(SHR = 1.021)í•˜ë‚˜, p = 0.63ìœ¼ë¡œ í†µê³„ì ìœ¼ë¡œ ìœ ì˜í•˜ì§€ ì•ŠìŒ.
> -   **sex** (`sex = 1` vs `0`): ë‚¨ì„±ì˜ ì „ì´ ëˆ„ì ìœ„í—˜ì´ ì—¬ì„± ëŒ€ë¹„ ì•½ 44.5% ê°ì†Œ(SHR = 0.555)í•˜ë‚˜, p = 0.34ìœ¼ë¡œ ìœ ì˜í•˜ì§€ ì•ŠìŒ.

### ğŸŸª ëª¨ë¸ ì í•©ë„

-   **Pseudo likelihood ratio test** = 1.39 on 2 df (p \> 0.05) â†’ ëª¨ë¸ì— í¬í•¨ëœ `age`, `sex` ê³µë³€ëŸ‰ ì „ì²´ê°€ ìœ ì˜ë¯¸í•œ ì„¤ëª…ë ¥ì„ ê°–ì§€ ì•ŠìŒ
-   **ì´ ê´€ì¸¡ì¹˜ ìˆ˜** = 54

### ğŸŸª ê²°ë¡  ë° ë‹¤ìŒ ë‹¨ê³„ ì œì•ˆ

> ### **í˜„ì¬ ê²°ê³¼**: `age`, `sex` ëª¨ë‘ ì „ì´ ì‚¬ê±´ì˜ subdistribution hazardì— **ìœ ì˜í•œ ì˜í–¥ ì—†ìŒ**

# ğŸŸ¥ 5. Bayesian ìƒì¡´ë¶„ì„

## ğŸŸ¨ Exponentialâ€“Cox ëª¨ë¸

### ğŸŸª ëª¨í˜• ì í•© ë° ê²°ê³¼ í™•ì¸

```{r bayes-expo-cox}
# 1. íŒ¨í‚¤ì§€ ë¡œë“œ
library(brms)      # Bayesian ëª¨ë¸ë§ (HMC)
library(survival)  # Surv ê°ì²´
library(loo)       # LOO-CV, WAIC

# 2. ë°ì´í„° ì¤€ë¹„
df$time_years <- df$time_to_event / 365  
example_data <- data.frame(
  age    = df$age,
  time   = df$time_years,
  status = as.integer(df$transition)
)

# 3. ëª¨ë¸ ê³µì‹ ì •ì˜
surv_formula <- bf(time | cens(status) ~ age)

# 4. ì‚¬ì „ë¶„í¬ ì„¤ì •
priors <- c(
  set_prior("normal(-8, 2)", class = "Intercept"),
  set_prior("normal(0.07, 0.03)", class = "b", coef = "age")
)

# 5. ëª¨ë¸ ì í•©
# fit_surv_bayes <- brm(
#   formula = surv_formula,
#   family  = brms::exponential(),
#   data    = example_data,
#   prior   = priors,
#   iter    = 2000,
#   warmup  = 500,
#   chains  = 4,
#   cores   = 4,
#   seed    = 42
# )


# save(fit_surv_bayes, file = file.path(path_save, "fit_surv_bayes.RData"))
load(file.path(path_save, "fit_surv_bayes.RData"))

# 6. ê²°ê³¼ í™•ì¸
summary(fit_surv_bayes)
```

|     |
|-----|

| íŒŒë¼ë¯¸í„° | Estimate | 95% CrI | í•´ì„ |
|-----------------------------|-------------|-------------|------------------|
| **Intercept** | â€“0.20 | \[â€“1.27, 0.82\] | age = 0 (ì˜ˆ: 0ì„¸)ì—ì„œì˜ **ê¸°ëŒ€ log-ìƒì¡´ì‹œê°„** = â€“0.20 |
| â†’ $\mu = e^{-0.20}\approx 0.82$ë…„ |  |  |  |
| **age** | 0.02 | \[â€“0.02, 0.06\] | ì—°ë ¹ì´ 1ë…„ ì¦ê°€í•  ë•Œ **ê¸°ëŒ€ log-ìƒì¡´ì‹œê°„**ì´ +0.02 ì¦ê°€ |
| â†’ ìƒì¡´ì‹œê°„ ì•½ 2% ì¦ê°€, í•´ì €ë“œ ì•½ 2% ê°ì†Œ ($\mathrm{HR}=e^{-0.02}\approx0.98$) |  |  |  |

-   **Credible Interval**ì— 0ì„ í¬í•¨í•˜ë¯€ë¡œ, age íš¨ê³¼ëŠ” **í†µê³„ì ìœ¼ë¡œ ìœ ì˜í•˜ì§€ ì•ŠìŒ**
-   **Rhat â‰ˆ 1.00**, **Bulk_ESS/Tail_ESS â‰« 200**: MCMC ìˆ˜ë ´ ì–‘í˜¸, ìœ íš¨í‘œë³¸ ì¶©ë¶„

### ğŸŸª ê²°ë¡ 

1.  ì—°ë ¹ì´ í•œ ì‚´ ë§ì•„ì§ˆìˆ˜ë¡ ë°œë³‘ê¹Œì§€ì˜ ê¸°ëŒ€ìƒì¡´ì‹œê°„ì´ ì•½ 2% ëŠ˜ì–´ë‚˜ëŠ”(ìœ„í—˜ 2% ê°ì†Œ) ê²½í–¥ì´ ê´€ì°°ë˜ë‚˜, 95% CrIì— 0ì´ í¬í•¨ë˜ì–´ **ìœ ì˜ë¯¸í•œ íš¨ê³¼**ë¼ ë‹¨ì •í•  ìˆ˜ ì—†ìŒ
2.  age = 0 ê¸°ì¤€ì˜ í•´ì„ì€ í˜„ì‹¤ì ì´ì§€ ì•Šìœ¼ë¯€ë¡œ, **ageë¥¼ ì¤‘ì•™ì •ë ¬(center)** í•œ ë³€í˜• ëª¨ë¸ì„ ê³ ë ¤í•˜ë©´ Interceptë¥¼ â€œí‰ê· ì—°ë ¹ì—ì„œì˜ ê¸°ëŒ€ìƒì¡´ì‹œê°„â€ìœ¼ë¡œ ì§ê´€ì  í•´ì„ ê°€ëŠ¥

------------------------------------------------------------------------

## ğŸŸ¨ Exponentialâ€“Cox (ë‚˜ì´ ì¤‘ì•™ì •ë ¬)

### ğŸŸª ëª¨í˜• ì í•© ë° ê²°ê³¼ í™•ì¸

```{r bayes-expo-cox-center}
# 1. age ì¤‘ì•™ì •ë ¬
df$age_c <- df$age - mean(df$age)

# 2. ë°ì´í„° ì¤€ë¹„
example_data <- data.frame(
  age_c  = df$age_c,
  time   = df$time_to_event / 365,
  status = as.integer(df$transition)
)

# 3. ëª¨ë¸ ê³µì‹ ì •ì˜
surv_formula <- bf(time | cens(status) ~ age_c)

# 4. ì‚¬ì „ë¶„í¬ ì„¤ì •
priors <- c(
  set_prior("normal(-8, 2)", class = "Intercept"),
  set_prior("normal(0.07, 0.03)", class = "b", coef = "age_c")
)

# 5. ëª¨ë¸ ì í•©
# fit_surv_bayes_2 <- brm(
#   formula = surv_formula,
#   family  = brms::exponential(),
#   data    = example_data,
#   prior   = priors,
#   iter    = 2000,
#   warmup  = 500,
#   chains  = 4,
#   cores   = 4,
#   seed    = 42
# )

# save(fit_surv_bayes_2, file = file.path(path_save, "fit_surv_bayes_2.RData"))
load(file.path(path_save, "fit_surv_bayes_2.RData"))

# 6. ê²°ê³¼ í™•ì¸
summary(fit_surv_bayes_2)
```

| íŒŒë¼ë¯¸í„° | Estimate | 95% Credible Interval | í•´ì„ |
|-----------|-----------|-----------|---------------------------------------|
| **Intercept** | 0.25 | \[â€“0.04, 0.55\] | `age_c = 0` (í‰ê·  ì—°ë ¹)ì—ì„œì˜ **ê¸°ëŒ€ log-ìƒì¡´ì‹œê°„** = 0.25 |
| â†’ (\mu = e\^{0.25}\approx 1.28)ë…„ |  |  |  |
| **age_c** | 0.02 | \[â€“0.02, 0.06\] | ì—°ë ¹ì´ í‰ê· ë³´ë‹¤ 1ë…„ ë†’ì•„ì§ˆ ë•Œ ê¸°ëŒ€ log-ìƒì¡´ì‹œê°„ì´ +0.02 ì¦ê°€ |
| â†’ ìƒì¡´ì‹œê°„ ì•½ 2% ì¦ê°€, í•´ì €ë“œ ì•½ 2% ê°ì†Œ ((\mathrm{HR}=e\^{-0.02}\approx0.98)) |  |  |  |

-   **Credible Interval**ì´ 0ì„ í¬í•¨í•˜ë¯€ë¡œ, `age_c` íš¨ê³¼ëŠ” **í†µê³„ì ìœ¼ë¡œ ìœ ì˜í•˜ì§€ ì•ŠìŒ**\
-   **Rhat â‰ˆ 1.00**, **Bulk_ESS/Tail_ESS â‰« 200**: MCMC ìˆ˜ë ´ ì–‘í˜¸, ìœ íš¨í‘œë³¸ ì¶©ë¶„

### ğŸŸª ê²°ë¡ 

1.  í‰ê·  ì—°ë ¹ ëŒ€ë¹„ 1ë…„ ì¦ê°€ ì‹œ ìƒì¡´ì‹œê°„ì´ ì•½ 2% ëŠ˜ì–´ë‚˜ê³  í•´ì €ë“œëŠ” ì•½ 2% ì¤„ì–´ë“œëŠ” ê²½í–¥ ê´€ì°°\
2.  ê·¸ëŸ¬ë‚˜ 95% CrIê°€ 0ì„ í¬í•¨í•˜ì—¬ **ìœ ì˜ë¯¸í•œ íš¨ê³¼**ë¼ ë‹¨ì •í•  ìˆ˜ ì—†ìŒ\
3.  ë¶„ì„ í¸ì˜ë¥¼ ìœ„í•´ **age_c**ë¥¼ ì‚¬ìš©í–ˆìœ¼ë¯€ë¡œ, InterceptëŠ” â€œí‰ê·  ì—°ë ¹ì—ì„œì˜ ê¸°ëŒ€ìƒì¡´ì‹œê°„â€ì„ ë‚˜íƒ€ëƒ„

## ğŸŸ¨ 5. Bayesian Mixture Cure Model (Stan)

### ğŸŸª ëª¨í˜• ì í•©

```{r bayes-cure-stan}
library(rstan)
library(loo)
library(bayesplot)
library(ggplot2)

# 1. Stan ì½”ë“œ ì •ì˜
stan_code <- "
data {
  int<lower=1> N;
  vector[N] age;             
  vector<lower=0>[N] time;   
  int<lower=0,upper=1> status[N];
}
parameters {
  real beta0;
  real beta_age;
  real<lower=0> k;
  real alpha0;
  real alpha_age;
}
transformed parameters {
  vector[N] log_lambda = beta0 + beta_age * age;
  vector[N] pi        = inv_logit(alpha0 + alpha_age * age);
}
model {
  beta0     ~ normal(-8, 2);
  beta_age  ~ normal(0.07, 0.03);
  k         ~ gamma(1, 1);
  alpha0    ~ normal(0.4, 1);
  alpha_age ~ normal(0.1, 0.05);
  for (i in 1:N) {
    if (status[i] == 1) {
      target += log1m(pi[i])
                + weibull_lpdf(time[i] | k, exp(log_lambda[i]));
    } else {
      real Su = exp(- pow(time[i], k) * exp(log_lambda[i]));
      target += log(pi[i] + (1 - pi[i]) * Su);
    }
  }
}
generated quantities {
  vector[N] log_lik;
  for (i in 1:N) {
    if (status[i] == 1) {
      log_lik[i] = log1m(pi[i])
                   + weibull_lpdf(time[i] | k, exp(log_lambda[i]));
    } else {
      real Su = exp(- pow(time[i], k) * exp(log_lambda[i]));
      log_lik[i] = log(pi[i] + (1 - pi[i]) * Su);
    }
  }
}
"

# 2. ë°ì´í„° ë¦¬ìŠ¤íŠ¸ ìƒì„±
df$age_c <- df$age - mean(df$age)
stan_data <- list(
  N      = nrow(df),
  age    = df$age_c,
  time   = df$time_to_event / 365,
  status = as.integer(df$transition)
)

# 3. Stan ëª¨ë¸ ë¹Œë“œ & ìƒ˜í”Œë§
# fit_cure_inline <- stan(
#   model_code = stan_code,
#   data       = stan_data,
#   iter       = 4000,
#   warmup     = 1000,
#   chains     = 4,
#   cores      = 4,
#   seed       = 123
# )

# save(fit_cure_inline, file = file.path(path_save, "fit_cure_inline.RData"))
load(file.path(path_save, "fit_cure_inline.RData"))


```

### ğŸŸª íŒŒë¼ë¯¸í„° ìš”ì•½ í•´ì„

```{r}
# 4. íŒŒë¼ë¯¸í„° ìš”ì•½
print(fit_cure_inline,
      pars  = c("beta0","beta_age","k","alpha0","alpha_age"),
      probs = c(0.025,0.5,0.975))

```

| íŒŒë¼ë¯¸í„° | í‰ê·  (mean) | 95% CrI | í•´ì„ |
|-----------------|----------------|------------------------|----------------|
| **beta0** | â€“2.39 | \[â€“3.91, â€“1.38\] | `age_c = 0` (í‰ê·  ì—°ë ¹)ì—ì„œ **uncured ê·¸ë£¹ì˜ ë¡œê·¸ ìœ„í—˜ë¥ **. |
| â†’ (\lambda\_0 = e\^{-2.39} \approx 0.09)ìœ¼ë¡œ ë‚®ì€ ì´ˆê¸° ìœ„í—˜ë¥  |  |  |  |
| **beta_age** | +0.07 | \[0.02, 0.12\] | ì—°ë ¹ì´ 1ë…„ ì¦ê°€í•˜ë©´ **uncured ê·¸ë£¹ì—ì„œ ì‚¬ê±´ ë°œìƒ ìœ„í—˜ë¥ **ì´ ì•½ 7% ì¦ê°€ |
| â†’ \$\mathrm{HR} \approx e\^{0.07} \approx 1.07\$, **í†µê³„ì ìœ¼ë¡œ ìœ ì˜í•¨** |  |  |  |
| **k** | 0.46 | \[0.23, 0.76\] | **Weibull shape parameter** |
| â†’ (k \< 1) â†’ ì‹œê°„ì´ ì§€ë‚ ìˆ˜ë¡ ì‚¬ê±´ ìœ„í—˜ì´ ê°ì†Œí•˜ëŠ” í˜•íƒœ |  |  |  |
| **alpha0** | â€“1.49 | \[â€“2.84, â€“0.22\] | í‰ê·  ì—°ë ¹ì—ì„œ **ì™„ì¹˜(logit) intercept** |
| â†’ (\pi\_0 = \mathrm{logit}\^{-1}(-1.49) \approx 18%) ì™„ì¹˜ìœ¨ ì¶”ì • |  |  |  |
| **alpha_age** | +0.08 | \[â€“0.01, 0.17\] | ë‚˜ì´ê°€ ë§ì„ìˆ˜ë¡ ì™„ì¹˜ë  í™•ë¥ ì´ ì¦ê°€í•˜ëŠ” ê²½í–¥ |
| â†’ í•˜ì§€ë§Œ 95% CrIì— 0ì´ í¬í•¨ë˜ì–´ **ê²½ê³„ì ìœ¼ë¡œ ìœ ì˜í•¨** |  |  |  |

------------------------------------------------------------------------

#### ìš”ì•½ í•´ì„

-   **Uncured ê·¸ë£¹ì˜ ìœ„í—˜ë¥ **ì€ í‰ê·  ì—°ë ¹ì—ì„œ ë‚®ìœ¼ë©°(\$\\lambda_0 \\approx 0.09\$),\
    **ì‹œê°„ì´ ì§€ë‚ ìˆ˜ë¡ ê°ì†Œ**í•˜ëŠ” í˜•íƒœ ((k \< 1))ë¥¼ ë”°ë¦„.
-   **ì—°ë ¹ì´ ë†’ì„ìˆ˜ë¡ ì‚¬ê±´ ë°œìƒ ìœ„í—˜ì´ ìœ ì˜ë¯¸í•˜ê²Œ ì¦ê°€**í•˜ë©° (ì•½ +7%/ë…„),\
    **ì™„ì¹˜ í™•ë¥ ë„ ì¦ê°€í•˜ëŠ” ê²½í–¥**ì„ ë³´ì´ì§€ë§Œ ê·¸ íš¨ê³¼ëŠ” í†µê³„ì ìœ¼ë¡œ ìœ ì˜í•˜ì§€ ì•ŠìŒ.
-   **í‰ê·  ì—°ë ¹ í™˜ìì˜ ì™„ì¹˜ ë¹„ìœ¨ì€ ì•½ 18%ë¡œ ì¶”ì •**ë˜ì–´, ì¼ë¶€ ì˜êµ¬ì  ê´€í•´(cure) ì§‘ë‹¨ì´ ì¡´ì¬í•¨.

------------------------------------------------------------------------

#### ìˆ˜ë ´ ì§„ë‹¨ ê²°ê³¼

-   **Rhat = 1.00**, **n_eff â‰« 1000** â†’ MCMC ì²´ì¸ ìˆ˜ë ´ ìš°ìˆ˜, posterior ì¶”ì • ì‹ ë¢°ë„ ë†’ìŒ

### ğŸŸª ì‚¬í›„ë¶„í¬ ì‹œê°í™”

```{r}

# 6. Posterior ë¶„í¬ ì‹œê°í™”
post_array <- as.array(fit_cure_inline)
mcmc_areas(
  post_array,
  pars = c("beta0","beta_age","alpha0","alpha_age","k"),
  prob = 0.95
) + labs(
  title = "Mixture Cure Model Posterior Distributions",
  x     = "Value",
  y     = "Parameter"
)


```

| íŒŒë¼ë¯¸í„° | ì¤‘ì•™ê°’ (50%ile) | 95% CrI | í˜•íƒœ & í•´ì„ |
|-----------|-----------|-----------|---------------------------------------|
| **beta0** | â€“2.30 | \[â€“3.91, â€“1.38\] | ë¹„êµì  ì¢ì€ ë¶„í¬<br>í‰ê· ì—°ë ¹ì—ì„œ uncured ê·¸ë£¹ì˜ log ìœ„í—˜ë¥  intercept |
| **beta_age** | +0.07 | \[0.02, +0.12\] | ì•„ì£¼ ì¢ì€ ë¶„í¬ (ì •ë°€ë„ ë†’ìŒ)<br>ì—°ë ¹ 1ë…„â†‘ ì‹œ uncured ìœ„í—˜ë¥  ì•½ 7%â†‘ (ëª¨ë‘ ì–‘ìˆ˜â†’í†µê³„ì  ìœ ì˜) |
| **alpha0** | â€“1.47 | \[â€“2.84, â€“0.22\] | ì¤‘ê°„ í­ ë¶„í¬<br>í‰ê· ì—°ë ¹ì—ì„œ ì™„ì¹˜ í™•ë¥  intercept ((\pi\_0\approx18%)) |
| **alpha_age** | +0.08 | \[â€“0.01, +0.17\] | ì¤‘ê°„ í­ ë¶„í¬<br>ì—°ë ¹ 1ë…„â†‘ ì‹œ ì™„ì¹˜ í™•ë¥  ì¦ê°€ ê²½í–¥, 95% CrI ì¼ë¶€ ìŒìˆ˜ í¬í•¨(ê²½ê³„ì  ìœ ì˜ì„±) |
| **k** | +0.45 | \[0.23, +0.76\] | ìƒëŒ€ì ìœ¼ë¡œ ë„“ì€ ë¶„í¬<br>Weibull shape (k\<1)â†’ì‹œê°„ ê²½ê³¼ ì‹œ uncured ê·¸ë£¹ì˜ hazard ê°ì†Œí•¨ì„ ì‹œì‚¬ |

-   **ë¶„í¬ í­ (CrI ê¸¸ì´)**:
    -   `beta_age`ê°€ ê°€ì¥ ì¢ì•„ posterior ë¶ˆí™•ì‹¤ì„± ì ìŒ\
    -   `alpha_age`, `k`ëŠ” ìƒëŒ€ì ìœ¼ë¡œ í­ì´ ë„“ì–´ ë¶ˆí™•ì‹¤ì„± ë‹¤ì†Œ í¼\
-   **ì¤‘ì•™ê°’ ìœ„ì¹˜**:
    -   `beta_age`, `alpha_age` ëª¨ë‘ ì–‘ìˆ˜ ì¤‘ì•™ê°’ â†’ ì—°ë ¹ íš¨ê³¼ê°€ ì¼ê´€ë˜ê²Œ positive\
    -   `beta0`, `alpha0` ëŠ” ìŒìˆ˜ ì¤‘ì•™ê°’ â†’ ë‚®ì€ baseline ìœ„í—˜ë¥ /ì™„ì¹˜í™•ë¥ 

> **ê²°ë¡ **: ì—°ë ¹ì´ ë†’ì„ìˆ˜ë¡ uncured ì‚¬ê±´ ìœ„í—˜ì´ ìœ ì˜í•˜ê²Œ ì¦ê°€í•˜ê³ (`beta_age`),\
> ì™„ì¹˜ í™•ë¥ ë„ ì¦ê°€ ê²½í–¥ì„ ë³´ì´ë‚˜(`alpha_age`) ì¼ë¶€ ë¶ˆí™•ì‹¤ì„±ì´ ë‚¨ì•„ ìˆìŒ.\
> Weibull shape (`k`) ë¶„í¬ë¥¼ í†µí•´ ì „ì²´ uncured hazardê°€ ì‹œê°„ì´ ì§€ë‚¨ì— ë”°ë¼ ê°ì†Œí•¨ì„ ì‹œê°ì ìœ¼ë¡œ í™•ì¸í•  ìˆ˜ ìˆìŒ.
